<!DOCTYPE html>
<!-- saved from url=(0088)http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1 -->
<html lang="en-US" class="chrome"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/cc.js"></script><script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/itunes_autolinkmaker.js"></script><script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/ga.js"></script><script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/cse.js"></script><script id="facebook-jssdk" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/all.js"></script><script type="text/javascript" lang="en">var rootTag = document.getElementsByTagName("html");var classes = rootTag[0].className;rootTag[0].className = classes.replace("no-js","");if (navigator.appVersion.indexOf("Win")==-1) { classes = rootTag[0].className;rootTag[0].className = classes.replace("windows","") } </script>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
							<title>How to Make a Game Like Candy Crush with Swift Tutorial</title>


								<meta property="og:title" content="How to Make a Game Like Candy Crush with Swift Tutorial">
				<meta property="og:type" content="article">
				<meta property="og:site_name" content="Ray Wenderlich">
        		<meta property="og:url" content="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1">
				<meta property="og:description" content="Learn how to make a game like Candy Crush for your iPhone in this 2-part tutorial series - and get a great Swift tutorial along the way!">
									<meta property="og:image" content="http://cdn5.raywenderlich.com/wp-content/uploads/2014/02/Teaser-image.png">
					
<!-- This site is optimized with the Yoast WordPress SEO plugin v1.5.3.2 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Learn how to make a game like Candy Crush for your iPhone in this 2-part tutorial series - and get a great Swift tutorial along the way!">
<link rel="canonical" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/How to Make a Game Like Candy Crush with Swift Tutorial.html">
<!-- / Yoast WordPress SEO plugin. -->

<link rel="stylesheet" id="style-main-css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="swiftype-css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/autocomplete.css" type="text/css" media="all">
<link rel="stylesheet" id="videojs-plugin-css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/plugin-styles.css" type="text/css" media="all">
<link rel="stylesheet" id="videojs-css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/video-js.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-polls-css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/polls-css.css" type="text/css" media="all">
<script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/player.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var swiftypeParams = {"engineKey":"omdTFN4ka9Dq1GBywQZq"};
/* ]]> */
</script>
<script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/install_swiftype.min.js"></script>
<script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/jquery.js"></script>
<script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/jquery-migrate.min.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.raywenderlich.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn5.raywenderlich.com/wp-includes/wlwmanifest.xml"> 

<link rel="shortlink" href="http://www.raywenderlich.com/?p=75270">
<script type="text/javascript"><!--
function powerpress_pinw(pinw){window.open('http://www.raywenderlich.com/?powerpress_pinw='+pinw, 'PowerPressPlayer','toolbar=0,status=0,resizable=1,width=460,height=320');	return false;}
powerpress_url = 'http://cdn1.raywenderlich.com/wp-content/plugins/powerpress/';
//-->
</script>
<script type="text/javascript">var icl_lang = 'en';var icl_home = 'http://www.raywenderlich.com/';</script>
<meta name="generator" content="WPML ver:2.7.1 stt:1,61,4,28,47,2,29;0">

		<script type="text/javascript"> document.createElement("video");document.createElement("audio");document.createElement("track"); </script>
		<style type="text/css">
.wp-polls .pollbar {
	margin: 1px;
	font-size: 6px;
	line-height: 8px;
	height: 8px;
	background-image: url('http://www.raywenderlich.com/wp-content/plugins/wp-polls/images/default/pollbg.gif');
	border: 1px solid #c8c8c8;
}
</style>
<script type="text/javascript">
(function(url){
if(/(?:Chrome\/26\.0\.1410\.63 Safari\/537\.31|WordfenceTestMonBot)/.test(navigator.userAgent)){ return; }
var wfscr = document.createElement('script');
wfscr.type = 'text/javascript';
wfscr.async = true;
wfscr.src = url + '&r=' + Math.random();
(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(wfscr);
})('//www.raywenderlich.com/wp-admin/admin-ajax.php?action=wordfence_logHuman&hid=4C6F5924BDDDCA23FA46D945A8F2BE33'); 
</script><script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/admin-ajax.php"></script>		<link rel="stylesheet" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/print.css" type="text/css" media="print">
		<link rel="profile" href="http://gmpg.org/xfn/11">
		<link rel="pingback" href="http://www.raywenderlich.com/xmlrpc.php">	
		<script>var siteUrl = 'http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich'</script>
		<script src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/global_combined.1.0.7.js" type="text/javascript"></script><script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/bsa.js"></script><script type="text/javascript" async="" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/a.min.js"></script>
		<script src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/jquery-ui-1.10.2.custom.min.js"></script>
		<script src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/jquery.multi-accordion-1.5.3.js"></script>
	<script type="text/javascript" id="_bsap_js_39fcef7ed4520883d78f129c33995fd2" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/s_39fcef7ed4520883d78f129c33995fd2.js" async="async"></script><script src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/jsapi" type="text/javascript"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_connect_bar_container div,.fb_connect_bar_container span,.fb_connect_bar_container a,.fb_connect_bar_container img,.fb_connect_bar_container strong{background:none;border-spacing:0;border:0;direction:ltr;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal;vertical-align:baseline}.fb_connect_bar_container{position:fixed;left:0 !important;right:0 !important;height:42px !important;padding:0 25px !important;margin:0 !important;vertical-align:middle !important;border-bottom:1px solid #333 !important;background:#3b5998 !important;z-index:99999999 !important;overflow:hidden !important}.fb_connect_bar_container_ie6{position:absolute;top:expression(document.compatMode=="CSS1Compat"? document.documentElement.scrollTop+"px":body.scrollTop+"px")}.fb_connect_bar{position:relative;margin:auto;height:100%;width:100%;padding:6px 0 0 0 !important;background:none;color:#fff !important;font-family:"lucida grande", tahoma, verdana, arial, sans-serif !important;font-size:13px !important;font-style:normal !important;font-variant:normal !important;font-weight:normal !important;letter-spacing:normal !important;line-height:1 !important;text-decoration:none !important;text-indent:0 !important;text-shadow:none !important;text-transform:none !important;white-space:normal !important;word-spacing:normal !important}.fb_connect_bar a:hover{color:#fff}.fb_connect_bar .fb_profile img{height:30px;width:30px;vertical-align:middle;margin:0 6px 5px 0}.fb_connect_bar div a,.fb_connect_bar span,.fb_connect_bar span a{color:#bac6da;font-size:11px;text-decoration:none}.fb_connect_bar .fb_buttons{float:right;margin-top:7px}
.fbpluginrecommendationsbarleft,.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}.fbpluginrecommendationsbarleft{left:10px}.fbpluginrecommendationsbarright{right:10px}</style><style type="text/css" id="bsa_css">div.bsap_1260352{width:100%;display:block}div.bsap_1260352 a{width:125px}div.bsap_1260352 a img{padding:0}div.bsap_1260352 a em{font-style:normal}div.bsap_1260352 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0;text-align:center;text-decoration:none;overflow:hidden;float:left;}div.bsap_1260352 img{border:0;clear:right; }div.bsap_1260352 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}div.bsap_1260352 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}div.bsap_1260352 a{line-height:100%}div.bsap_1260352 a.adhere{width:125px;height:125px;line-height:1000%}html>body div.bsap_1260352 a.adhere{width:123px;height:123px}div.bsap_1260352 img.s{height:0;width:0}div.bsap_1272017{width:100%;display:block}div.bsap_1272017 a{width:728px}div.bsap_1272017 a img{padding:0}div.bsap_1272017 a em{font-style:normal}div.bsap_1272017 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0;text-align:center;text-decoration:none;overflow:hidden;float:left;margin-bottom:10px;}div.bsap_1272017 img{border:0;clear:right;}div.bsap_1272017 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}div.bsap_1272017 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}div.bsap_1272017 a{line-height:100%}div.bsap_1272017 a.adhere{width:728px;height:90px;line-height:720%}html>body div.bsap_1272017 a.adhere{width:726px;height:88px}div.bsap_1272017 img.s{height:0;width:0}div.bsap_1272017{line-height:9px}div.bsap_1272017 .bsap_adhere2,div.bsap_1272017 iframe{float:left}div.bsap_1272017 .bsap_adhere2 a{height:90px;width:20px;background:url(http://s3.buysellads.com/ac/ah20x90_1.gif) no-repeat 0 0;text-indent:-9999px}div.bsap_1274837{width:100%;display:block}div.bsap_1274837 a{width:300px}div.bsap_1274837 a img{padding:0}div.bsap_1274837 a em{font-style:normal}div.bsap_1274837 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0;text-align:center;text-decoration:none;overflow:hidden;float:left;margin-bottom:10px;}div.bsap_1274837 img{border:0;clear:right;}div.bsap_1274837 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}div.bsap_1274837 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}div.bsap_1274837 a{line-height:100%}div.bsap_1274837 a.adhere{width:300px;height:250px;line-height:2000%}html>body div.bsap_1274837 a.adhere{width:298px;height:248px}div.bsap_1274837 img.s{height:0;width:0}div.bsap_1274837{line-height:9px}div.bsap_1274837 .bsap_adhere a{height:19px;width:298px;font-size:10px;background:#f1f1f1;border:1px solid #e1e1e1;border-top:none;border-bottom-left-radius:4px;-moz-border-radius-bottomleft:4px;-webkit-border-bottom-left-radius:4px;border-bottom-right-radius:4px;-moz-border-radius-bottomright:4px;-webkit-border-bottom-right-radius:4px;text-shadow:1px 1px 0 #fff;line-height:16px}.bsap_backfillframe{border:0}</style><link type="text/css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/default+en.css" rel="stylesheet"><link type="text/css" href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/default.css" rel="stylesheet"><script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/default+en.I.js"></script><script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/search.I.js"></script><style type="text/css">
.gsc-control-cse {
font-family: Arial, sans-serif;
border-color: #FFFFFF;
background-color: #FFFFFF;
}
.gsc-control-cse .gsc-table-result {
font-family: Arial, sans-serif;
}
input.gsc-input, .gsc-input-box, .gsc-input-box-hover, .gsc-input-box-focus {
border-color: #BCCDF0;
}
input.gsc-search-button, input.gsc-search-button:hover, input.gsc-search-button:focus {
border-color: #336699;
background-color: #E9E9E9;
background-image: none;
filter: none;
}
.gsc-tabHeader.gsc-tabhInactive {
border-color: #E9E9E9;
background-color: #E9E9E9;
}
.gsc-tabHeader.gsc-tabhActive {
border-color: #FF9900;
border-bottom-color: #FFFFFF;
background-color: #FFFFFF;
}
.gsc-tabsArea {
border-color: #FF9900;
}
.gsc-webResult.gsc-result,
.gsc-results .gsc-imageResult {
border-color: #FFFFFF;
background-color: #FFFFFF;
}
.gsc-webResult.gsc-result:hover,
.gsc-imageResult:hover {
border-color: #FFFFFF;
background-color: #FFFFFF;
}
.gs-webResult.gs-result a.gs-title:link,
.gs-webResult.gs-result a.gs-title:link b,
.gs-imageResult a.gs-title:link,
.gs-imageResult a.gs-title:link b {
color: #1155CC;
}
.gs-webResult.gs-result a.gs-title:visited,
.gs-webResult.gs-result a.gs-title:visited b,
.gs-imageResult a.gs-title:visited,
.gs-imageResult a.gs-title:visited b {
color: #1155CC;
}
.gs-webResult.gs-result a.gs-title:hover,
.gs-webResult.gs-result a.gs-title:hover b,
.gs-imageResult a.gs-title:hover,
.gs-imageResult a.gs-title:hover b {
color: #1155CC;
}
.gs-webResult.gs-result a.gs-title:active,
.gs-webResult.gs-result a.gs-title:active b,
.gs-imageResult a.gs-title:active,
.gs-imageResult a.gs-title:active b {
color: #1155CC;
}
.gsc-cursor-page {
color: #1155CC;
}
a.gsc-trailing-more-results:link {
color: #1155CC;
}
.gs-webResult .gs-snippet,
.gs-imageResult .gs-snippet,
.gs-fileFormatType {
color: #333333;
}
.gs-webResult div.gs-visibleUrl,
.gs-imageResult div.gs-visibleUrl {
color: #009933;
}
.gs-webResult div.gs-visibleUrl-short {
color: #009933;
}
.gs-webResult div.gs-visibleUrl-short {
display: none;
}
.gs-webResult div.gs-visibleUrl-long {
display: block;
}
.gs-promotion div.gs-visibleUrl-short {
display: none;
}
.gs-promotion div.gs-visibleUrl-long {
display: block;
}
.gsc-cursor-box {
border-color: #FFFFFF;
}
.gsc-results .gsc-cursor-box .gsc-cursor-page {
border-color: #E9E9E9;
background-color: #FFFFFF;
color: #1155CC;
}
.gsc-results .gsc-cursor-box .gsc-cursor-current-page {
border-color: #FF9900;
background-color: #FFFFFF;
color: #1155CC;
}
.gsc-webResult.gsc-result.gsc-promotion {
border-color: #336699;
background-color: #FFFFFF;
}
.gsc-completion-title {
color: #1155CC;
}
.gsc-completion-snippet {
color: #333333;
}
.gs-promotion a.gs-title:link,
.gs-promotion a.gs-title:link *,
.gs-promotion .gs-snippet a:link {
color: #0000FF;
}
.gs-promotion a.gs-title:visited,
.gs-promotion a.gs-title:visited *,
.gs-promotion .gs-snippet a:visited {
color: #663399;
}
.gs-promotion a.gs-title:hover,
.gs-promotion a.gs-title:hover *,
.gs-promotion .gs-snippet a:hover {
color: #0000FF;
}
.gs-promotion a.gs-title:active,
.gs-promotion a.gs-title:active *,
.gs-promotion .gs-snippet a:active {
color: #0000FF;
}
.gs-promotion .gs-snippet,
.gs-promotion .gs-title .gs-promotion-title-right,
.gs-promotion .gs-title .gs-promotion-title-right * {
color: #000000;
}
.gs-promotion .gs-visibleUrl,
.gs-promotion .gs-visibleUrl-short {
color: #008000;
}
</style></head>
	
	<body class="single single-post postid-75270 single-format-standard" data-twttr-rendered="true"> 
		<div id="wrapper">
			<header id="branding" class="rw_subservice">
				<div id="site-details" class="wrapper clearfix rw_subservice">
					<hgroup id="site-logo" class="clearfix">
						<h1 id="site-title"><a href="http://www.raywenderlich.com/" title="Ray Wenderlich" class="image" rel="home" sl-processed="1">Ray Wenderlich</a></h1>
						<h2 id="site-name"><a href="http://www.raywenderlich.com/" sl-processed="1"><span class="first-name">RAY</span><span class="last-name">WENDERLICH</span></a></h2>
						<h2 id="site-motto"><a href="http://www.raywenderlich.com/" sl-processed="1">TUTORIALS FOR DEVELOPERS &amp; GAMERS</a></h2>		
						<h2 id="site-description"><a href="http://www.raywenderlich.com/" border="0" sl-processed="1">Tutorials for iPhone / iOS Developers and Gamers</a></h2>
					</hgroup>
					<nav class="navtext">
						<h1>Site Navigation</h1>
						<ul id="user-account-navigation" class="logged-in">
							<li class="login">					<ul id="user-account-navigation" class="logged-out">
						<li class="login-link"><a href="http://www.raywenderlich.com/login" sl-processed="1">LOGIN</a></li>
						<li class="separator"></li>
						<li class="sign-out-link"><a href="http://www.raywenderlich.com/login?section=new-account" sl-processed="1">SIGN UP</a></li>
					</ul>
				</li>
							<script>			
								jQuery.ajax({
									type : "POST",
									data : { "javascript" : "false" },
									url : "http://www.raywenderlich.com/wp-content/themes/raywenderlich/templates/login_area.php",
									cache : false,
								}).done(function(html) {
									jQuery("#user-account-navigation li").html(html);	
								})
							</script>
						</ul>			    
						<ul id="sitewide-nagivation">
							<li class="about"><a href="http://www.raywenderlich.com/about" sl-processed="1">About</a></li>
							<li class="language">
								<ul id="languagenav">
			    	    			<li id="language">
			    	    							    	    			</li>
								</ul>
							</li>
						</ul>
					</nav>
				</div>
				<div class="navigation-band rw_subservice">
					<div class="wrapper clearfix">
						<ul id="subnav" class="navtext">
							<li class="ios-games separator"></li>
							<li id="all-tutorials"><a class="verbose-link" href="http://www.raywenderlich.com/tutorials" sl-processed="1">Written Tutorials</a><a class="abridged-link" href="http://www.raywenderlich.com/tutorials" sl-processed="1">Written</a></li>
							<li class="separator"></li>
							<li id="videos"><a class="verbose-link" href="http://www.raywenderlich.com/video-tutorials" sl-processed="1">Video Tutorials (Beta)</a><a href="http://www.raywenderlich.com/video-tutorials" class="abridged-link" sl-processed="1">Video</a></li>
							<li class="separator"></li>
							<li id="podcasts"><a href="http://www.raywenderlich.com/rwpodcast" sl-processed="1">Podcast</a></li>
							<li class="separator"></li>
							<li id="ios-gaming"><a href="http://www.raywenderlich.com/forums" sl-processed="1">Forums</a></li>
							<li class="separator"></li>
							<li id="art"><a href="http://www.gameartguppy.com/" target="_blank" sl-processed="1">Art</a></li>
							<li class="separator"></li>
							<li id="games"><a href="http://www.raywenderlich.com/store" sl-processed="1">Store</a></li>
							<li class="separator"></li>
							<li class="search">
								<form action="http://www.raywenderlich.com/" class="searchform clearfix" method="get">
									<label class="assistive-text" for="s">Search</label>
									<input type="text" placeholder="Search for a tutorial" class="s field" name="s" autocomplete="off">
									<input type="hidden" name="cof" value="FORID:10">
								</form>
							</li>
						</ul>
					</div>
				</div>
				<div class="subnav-band "></div>
							<!-- .wrapper -->
			</header>
		</div>
		
		<div class="wrapper clearfix" id="print-header" style="display:none">
			<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/print-header.png" width="1202" height="102">	
		</div>
		<div id="main" class="wrapper clearfix">
			<div id="container">
	<div id="primary" class="no-margin-left">
		<div id="primary-container">
			<div class="banner-ad" syle="overflow:hidden">
				<!-- BuySellAds.com Ad Code -->
				<div id="bsap_1272017" class="bsap_1272017 bsap"><a href="http://stats.buysellads.com/click.go?z=1272017&b=4874007&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.2640868863090873&link=http://www.airpair.com/so13/ios?utm_source=bsa-raywenderlich&utm_medium=banner-ads&utm_term=ios-wain-glaister&utm_content=ios-leaderboard&utm_campaign=bsa01" onmouseover="window.status = &#39;http://www.airpair.com/so13/ios?utm_source=bsa-raywenderlich&amp;utm_medium=banner-ads&amp;utm_term=ios-wain-glaister&amp;utm_content=ios-leaderboard&amp;utm_campaign=bsa01&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad1 odd" title="AirPair Expert Marketplace" id="bsa_4874007" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/228374-1403838083.jpg" width="728" height="90" alt="AirPair Expert Marketplace"></a></div>
				<!-- End BuySellAds.com Ad Code -->
			</div>
			<div id="content">
								<article id="post-75270" class="post-75270 post type-post status-publish format-standard has-post-thumbnail hentry category-iphone tag-game tag-ios tag-sample-code tag-sprite-kit tag-swift tag-tutorial clearfix">
					<header class="entry-header">
						<h2 class="entry-title">
            				<a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/How to Make a Game Like Candy Crush with Swift Tutorial.html" title="How to Make a Game Like Candy Crush with Swift Tutorial: Part 1" sl-processed="1">How to Make a Game Like Candy Crush with Swift Tutorial: Part 1</a>
            			</h2>
            			<div class="tutorial-meta" id="larger-screens">
	            			<div class="author-meta">
								<a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file.php" width="100" height="100" class="user-avatar"></a> <a href="http://www.raywenderlich.com/u/Hollance" class="author-name" sl-processed="1">										Matthijs Hollemans</a> <span class="author-post-date">on June 24, 2014 </span>
											            			</div>
	            			<div class="social-links">
			    				<ul>
			    								    							<li class="twitter"><div id="tweetbutton75270m" class="tw_button" style="margin-bottom:10px;"><iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/tweet_button.1404859412.html" class="twitter-share-button twitter-tweet-button twitter-share-button twitter-count-horizontal" title="Twitter Tweet Button" data-twttr-rendered="true" style="width: 107px; height: 20px;"></iframe></div></li>
			    																<li class="facebook"><div class="fb-like fb_iframe_widget" data-href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;href=http%3A%2F%2Fwww.raywenderlich.com%2F75270%2Fmake-game-like-candy-crush-with-swift-tutorial-part-1&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=450"><span style="vertical-align: bottom; width: 79px; height: 20px;"><iframe name="fb558dc48" width="450px" height="1000px" frameborder="0" allowtransparency="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/like(3).html" style="border: none; visibility: visible; width: 79px; height: 20px;" class=""></iframe></span></div></li>
									<li class="facebook iframe-link"><iframe src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/like.html" allowtransparency="true" frameborder="0" scrolling="no" style="width: 74px; height: 20px;"></iframe></li>
			    				</ul>
			    			</div>
	            		</div>
					</header>
					<div class="content-wrapper">
						<div class="wwsgd" style="display:none;"><p style="border:thin dotted black; padding:3mm;margin-bottom:10px">If you're new here, you may want to subscribe to my <a href="http://www.raywenderlich.com/feed/" sl-processed="1">RSS feed</a> or follow me on <a href="http://twitter.com/rwenderlich" sl-processed="1">Twitter</a>. Thanks for visiting!</p></div><div id="attachment_66881" style="width: 260px" class="wp-caption alignright"><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Teaser-image.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Teaser-image.png" alt="Learn to make a tasty match-3 game in the new Swift language" width="250" height="250" class="size-full wp-image-66881"></a><p class="wp-caption-text">Learn to make a tasty match-3 game in the new Swift language</p></div>
<p><em>Update 7/8/14:</em> Updated for Xcode6-beta 3.</p>
<p>A little while back, I wrote an <a href="http://www.raywenderlich.com/66877/how-to-make-a-game-like-candy-crush-part-1" sl-processed="1">Objective-C tutorial</a> about how to make a game like the <a href="https://itunes.apple.com/us/app/candy-crush-saga/id553834731?mt=8&uo=4&at=11ld4k" target="itunes_store" sl-processed="1">Candy Crush Saga</a>, which is a very popular casual match-3 game. </p>
<p>But I thought it would be great to make a Swift version as well, hence this post! </p>
<p>In this Swift tutorial, you’ll learn how to make a game like Candy Crush named <em>Cookie Crunch Adventure</em>. Yum, that sounds even better than candy!</p>
<p>In the process of going through this tutorial, you’ll get some excellent practice with Swift techniques such as enums, generics, subscripting, closures, and extensions. You’ll also learn a lot about game architecture and best practices.</p>
<p>This is Part One of a two-part series. In this first part, you’ll put the foundation in place: the gameplay view, the sprites and some of the logic for detecting swipes and swapping cookies.</p>
<p>In the <a href="http://www.raywenderlich.com/75273/make-game-like-candy-crush-with-swift-tutorial-part-2" sl-processed="1">second part</a>, you’ll complete the gameplay and add the final polish to transform Cookie Crunch Adventure into a game of top-10 quality.</p>
<div class="note">
<p><em>Note:</em> This Swift tutorial assumes you have working knowledge of Sprite Kit and Swift. If you’re new to Sprite Kit, check out the <a href="http://www.raywenderlich.com/42699/spritekit-tutorial-for-beginners" sl-processed="1">beginner tutorials on the site</a> or our book, <a href="http://raywenderlich.com/store/ios-games-by-tutorials" sl-processed="1">iOS Games by Tutorials</a>. For an introduction to Swift, see our <a href="http://www.raywenderlich.com/74438/swift-tutorial-a-quick-start" sl-processed="1">Swift tutorial</a>.</p>
<p>This tutorial requires Xcode 6 beta 3 or later. At the time of writing this tutorial, our understanding is <a href="http://www.raywenderlich.com/74138/swift-language-faq" sl-processed="1">we cannot post screenshots</a> of Xcode 6 since it is still in beta. Therefore, we are suppressing Xcode 6 screenshots in this Swift tutorial until we are sure it is OK. (Any Xcode screenshots shown are taken from the <a href="http://www.raywenderlich.com/66877/how-to-make-a-game-like-candy-crush-part-1" sl-processed="1">Objective-C version</a> of this tutorial.)</p>
</div>
<h2>Getting Started</h2>
<p>Before you continue, <a href="http://cdn2.raywenderlich.com/wp-content/uploads/2014/02/Resources.zip" sl-processed="1">download the resources</a> for this Swift tutorial and unpack the zip file. You’ll have a folder containing all the images and sound effects you’ll need later on.</p>
<p>Start up Xcode 6, go to <em>File\New\Project…</em>, choose the <em>iOS\Application\Game</em> template and click <em>Next</em>. Fill out the options as follows:</p>
<ul>
<li>Product Name: <em>CookieCrunch</em></li>
<li>Language: <em>Swift</em></li>
<li>Game Technology: <em>SpriteKit</em></li>
<li>Devices: <em>iPhone</em></li>
</ul>
<p>Click <em>Next</em>, choose a folder for your project and click <em>Create</em>.</p>
<p>This is a portrait-only game, so open the <em>Target Settings</em> screen and in the <em>General</em> tab, make sure only <em>Portrait</em> is checked in the <em>Device Orientation</em> section:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Device-orientation.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Device-orientation.png" alt="Device orientation" width="322" height="85" class="aligncenter size-full wp-image-66886"></a></p>
<p>To start importing the graphics files, go to the <em>Resources</em> folder you just downloaded and drag the <em>Sprites.atlas</em> folder into Xcode’s Project Navigator. Make sure <em>Destination: Copy items if needed</em> is checked. </p>
<p>You should now have a blue folder in your project:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Sprites-atlas-in-project-navigator.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Sprites-atlas-in-project-navigator.png" alt="Sprites atlas in project navigator" width="259" height="109" class="aligncenter size-large wp-image-75403"></a></p>
<p>Xcode will automatically pack the images from this folder into a texture atlas when it builds the game. Using a texture atlas as opposed to individual images will dramatically improve your game’s drawing performance. </p>
<div class="note">
<p><em>Note:</em> To learn more about texture atlases and performance, check out Chapter 25 in <a href="http://raywenderlich.com/store/ios-games-by-tutorials" sl-processed="1">iOS Games by Tutorials</a>, “Sprite Kit Performance: Texture Atlases”.</p>
</div>
<p>There are a few more images to import, but they don’t go into a texture atlas. This is because they are either large full-screen background images (which are more efficient to keep outside of the texture atlas) or images that you will later use from UIKit controls (UIKit controls cannot access images inside texture atlases). </p>
<p>From the <em>Resources/Images</em> folder, drag each of the individual images into the asset catalog:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Images-in-asset-catalog.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Images-in-asset-catalog.png" alt="Images in asset catalog" width="681" height="302" class="aligncenter size-full wp-image-66890"></a></p>
<p>Delete the <em>Spaceship</em> image from the asset catalog. This is a sample image that came with the template but you won’t need any spaceships while crunching those tasty cookies! :]</p>
<p>Outside of the asset catalog in the Project Navigator, delete <em>GameScene.sks</em>. You won’t be using Xcode’s built-in level editor for this game.</p>
<p>Great! It’s time to write some code. Replace the contents of <em>GameViewController.swift</em> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p752701"><td class="code" id="p75270code1"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">import</span> UIKit
<span style="color: #a61390;">import</span> SpriteKit
&nbsp;
<span style="color: #a61390;">class</span> GameViewController<span style="color: #002200;">:</span> <span style="color: #400080;">UIViewController</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> scene<span style="color: #002200;">:</span> GameScene<span style="color: #002200;">!</span>
&nbsp;
  <span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> prefersStatusBarHidden<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #a61390;">true</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> shouldAutorotate<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #a61390;">true</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> supportedInterfaceOrientations<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Int</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">(</span>UIInterfaceOrientationMask.AllButUpsideDown.toRaw<span style="color: #002200;">(</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> viewDidLoad<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">super</span>.viewDidLoad<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Configure the view.</span>
    <span style="color: #a61390;">let</span> skView <span style="color: #002200;">=</span> view <span style="color: #a61390;">as</span> SKView
    skView.multipleTouchEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">false</span>
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Create and configure the scene.</span>
    scene <span style="color: #002200;">=</span> GameScene<span style="color: #002200;">(</span>size<span style="color: #002200;">:</span> skView.bounds.size<span style="color: #002200;">)</span>
    scene.scaleMode <span style="color: #002200;">=</span> .AspectFill
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Present the scene.</span>
    skView.presentScene<span style="color: #002200;">(</span>scene<span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This is mostly boilerplate code that creates the Sprite Kit scene and presents it in the <code>SKView</code>.</p>
<p>For the final piece of setup, replace the contents of <em>GameScene.swift</em> with this:</p>

<div class="wp_codebox"><table><tbody><tr id="p752702"><td class="code" id="p75270code2"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">import</span> SpriteKit
&nbsp;
<span style="color: #a61390;">class</span> GameScene<span style="color: #002200;">:</span> <span style="color: #400080;">SKScene</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">init</span><span style="color: #002200;">(</span>size<span style="color: #002200;">:</span> <span style="color: #400080;">CGSize</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">super</span>.<span style="color: #a61390;">init</span><span style="color: #002200;">(</span>size<span style="color: #002200;">:</span> size<span style="color: #002200;">)</span>
&nbsp;
    anchorPoint <span style="color: #002200;">=</span> <span style="color: #400080;">CGPoint</span><span style="color: #002200;">(</span>x<span style="color: #002200;">:</span> <span style="color: #2400d9;">0.5</span>, y<span style="color: #002200;">:</span> <span style="color: #2400d9;">0.5</span><span style="color: #002200;">)</span>
&nbsp;
    <span style="color: #a61390;">let</span> background <span style="color: #002200;">=</span> <span style="color: #400080;">SKSpriteNode</span><span style="color: #002200;">(</span>imageNamed<span style="color: #002200;">:</span> <span style="color: #bf1d1a;">"Background"</span><span style="color: #002200;">)</span>
    addChild<span style="color: #002200;">(</span>background<span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This loads the background image from the asset catalog and places it in the scene. Because the scene’s <code>anchorPoint</code> is (0.5, 0.5), the background image will always be centered on the screen on both 3.5-inch and 4-inch devices.</p>
<p>Build and run to see what you’ve got so far. Excellent!</p>
<p><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2014/02/Background-image.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Background-image-301x500.png" alt="Background image" width="301" height="500" class="aligncenter size-large wp-image-66884"></a></p>
<h2>Can I Have Some Cookies?</h2>
<p>This game’s playing field will consist of a grid, 9 columns by 9 rows. Each square of this grid can contain a cookie.</p>
<p><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2014/02/2D-grid.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/2D-grid-310x500.png" alt="2D grid" width="310" height="500" class="aligncenter size-large wp-image-66882"></a></p>
<p>Column 0, row 0 is in the bottom-left corner of the grid. Since the point (0,0) is also at the bottom-left of the screen in Sprite Kit’s coordinate system, it makes sense to have everything else “upside down”—at least compared to the rest of UIKit. :]</p>
<div class="note">
<p><em>Note:</em> Wondering why Sprite Kit’s coordinate system is different than UIKit’s? This is because OpenGL ES’s coordinate system has (0, 0) at the bottom-left, and Sprite Kit is built on top of OpenGL ES. </p>
<p>To learn more about OpenGL ES, we have a <a href="http://www.raywenderlich.com/69983/video-tutorial-beginner-opengl-es-glkit-part-0-introduction" sl-processed="1">video tutorial series</a> for that.</p>
</div>
<p>To being implementing this, you need to create the class representing a cookie object. Go to <em>File\New\File…</em>, choose the <em>iOS\Source\Swift File</em> template and click <em>Next</em>. Name the file <em>Cookie.swift</em> and click <em>Create</em>.</p>
<p>Replace the contents of <em>Cookie.swift</em> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p752703"><td class="code" id="p75270code3"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">import</span> SpriteKit
&nbsp;
<span style="color: #a61390;">enum</span> CookieType<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">case</span> Unknown <span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span>, Croissant, Cupcake, Danish, Donut, Macaroon, SugarCookie
<span style="color: #002200;">}</span>
&nbsp;
<span style="color: #a61390;">class</span> Cookie <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>
  <span style="color: #a61390;">var</span> row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>
  <span style="color: #a61390;">let</span> cookieType<span style="color: #002200;">:</span> CookieType
  <span style="color: #a61390;">var</span> sprite<span style="color: #002200;">:</span> <span style="color: #400080;">SKSpriteNode</span>?
&nbsp;
  <span style="color: #a61390;">init</span><span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, cookieType<span style="color: #002200;">:</span> CookieType<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">self</span>.column <span style="color: #002200;">=</span> column
    <span style="color: #a61390;">self</span>.row <span style="color: #002200;">=</span> row
    <span style="color: #a61390;">self</span>.cookieType <span style="color: #002200;">=</span> cookieType
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>The <code>column</code> and <code>row</code> properties let <code>Cookie</code> keep track of its position in the 2-D grid.</p>
<p>The <code>sprite</code> property is <i>optional</i>, hence the question mark after <code>SKSpriteNode</code>, because the cookie object may not always have its sprite set.</p>
<p>The <code>cookieType</code> property describes the—wait for it—<i>type</i> of the cookie, which takes a value from the <code>CookieType</code> enum. The type is really just a number from 1 to 6, but wrapping it in an enum allows you to work with easy-to-remember names instead of numbers.</p>
<p>You will deliberately not use cookie type <code>Unknown</code> (value 0). This value has a special meaning, as you’ll learn toward the end of this part of the tutorial. </p>
<p>Each cookie type number corresponds to a sprite image:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Cookie-types.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Cookie-types.png" alt="Cookie types" width="598" height="130" class="aligncenter size-full wp-image-66885"></a></p>
<p>In Swift, an enum isn’t just useful for associating symbolic names with numbers; you can also add functions and computed properties to an enum. Add the following code inside the <code>enum CookieType</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p752704"><td class="code" id="p75270code4"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> spriteName<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> spriteNames <span style="color: #002200;">=</span> <span style="color: #002200;">[</span>
    <span style="color: #bf1d1a;">"Croissant"</span>,
    <span style="color: #bf1d1a;">"Cupcake"</span>,
    <span style="color: #bf1d1a;">"Danish"</span>,
    <span style="color: #bf1d1a;">"Donut"</span>,
    <span style="color: #bf1d1a;">"Macaroon"</span>,
    <span style="color: #bf1d1a;">"SugarCookie"</span><span style="color: #002200;">]</span>
&nbsp;
  <span style="color: #a61390;">return</span> spriteNames<span style="color: #002200;">[</span>toRaw<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">]</span>
<span style="color: #002200;">}</span>
&nbsp;
<span style="color: #a61390;">var</span> highlightedSpriteName<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> highlightedSpriteNames <span style="color: #002200;">=</span> <span style="color: #002200;">[</span>
    <span style="color: #bf1d1a;">"Croissant-Highlighted"</span>,
    <span style="color: #bf1d1a;">"Cupcake-Highlighted"</span>,
    <span style="color: #bf1d1a;">"Danish-Highlighted"</span>,
    <span style="color: #bf1d1a;">"Donut-Highlighted"</span>,
    <span style="color: #bf1d1a;">"Macaroon-Highlighted"</span>,
    <span style="color: #bf1d1a;">"SugarCookie-Highlighted"</span><span style="color: #002200;">]</span>
&nbsp;
  <span style="color: #a61390;">return</span> highlightedSpriteNames<span style="color: #002200;">[</span>toRaw<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">]</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>The <code>spriteName</code> property returns the filename of the corresponding sprite image in the texture atlas. In addition to the regular cookie sprite, there is also a highlighted version that appears when the player taps on the cookie.</p>
<p>The <code>spriteName</code> and <code>highlightedSpriteName</code> properties simply look up the name for the cookie sprite in an array of strings. To find the index, you use <code>toRaw()</code> to convert the enum’s current value to an integer. Recall that the first useful cookie type, <code>Croissant</code>, starts at 1 but arrays are indexed starting at 0, so you need to subtract 1 to find the correct array index.</p>
<p>Every time a new cookie gets added to the game, it will get a random cookie type. It makes sense to add that as a function on <code>CookieType</code>. Add the following to the enum as well:</p>

<div class="wp_codebox"><table><tbody><tr id="p752705"><td class="code" id="p75270code5"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">static</span> <span style="color: #a61390;">func</span> random<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; CookieType <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> CookieType.fromRaw<span style="color: #002200;">(</span><span style="color: #a61390;">Int</span><span style="color: #002200;">(</span>arc4random_uniform<span style="color: #002200;">(</span><span style="color: #2400d9;">6</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span> <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">)</span><span style="color: #002200;">!</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This calls <code>arc4random_uniform()</code> to generate a random number between 0 and 5, then adds 1 to make it a number between 1 and 6. Because Swift is very strict, the result from <code>arc4random_uniform()</code> (an UInt32) must first be converted to an Int, and then <code>fromRaw()</code> can convert this number into a proper <code>CookieType</code> value.</p>
<p>Now, you may wonder why you’re not making <code>Cookie</code> a subclass of <code>SKSpriteNode</code>. After all, the cookie is something you want to display on the screen.</p>
<p>If you’re familiar with the model-view-controller (or MVC) pattern, think of <code>Cookie</code> as a model object that simply describes the data for the cookie. The view is a separate object, stored in the <code>sprite</code> property.</p>
<p>This kind of separation between data models and views is something you’ll use consistently throughout this tutorial. The MVC pattern is more common in regular apps than in games but, as you’ll see, it can help keep the code clean and flexible.</p>
<h2>Printing Cookies</h2>
<p>If you were to use <code>println()</code> to print out a <code>Cookie</code> at the moment, it wouldn’t look very nice.</p>
<p>What you’d like is to customize the output of when you print a cookie. You can do this by making the <code>Cookie</code> conform to the <code>Printable</code> protocol. </p>
<p>To do this, modify the declaration of <code>Cookie</code> as follows:</p>

<div class="wp_codebox"><table><tbody><tr id="p752706"><td class="code" id="p75270code6"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Cookie<span style="color: #002200;">:</span> <span style="color: #a61390;">Printable</span> <span style="color: #002200;">{</span></pre></td></tr></tbody></table></div>

<p>Then add a computed property named <code>description</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p752707"><td class="code" id="p75270code7"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> description<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> <span style="color: #bf1d1a;">"type:<span style="color: #2400d9;">\(</span>cookieType) square:(<span style="color: #2400d9;">\(</span>column),<span style="color: #2400d9;">\(</span>row))"</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Now <code>println()</code> will print out something helpful: the type of cookie and its column and row in the level grid. You’ll use this in practice later.</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/print_cookies.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/print_cookies.png" alt="print_cookies" width="651" height="241" class="aligncenter size-full wp-image-70269"></a></p>
<p>Let’s also make the <code>CookieType</code> enum printable. Add the <code>Printable</code> protocol to the enum definition and have the <code>description</code> property return the sprite name, which is a pretty good description of the cookie type:</p>

<div class="wp_codebox"><table><tbody><tr id="p752708"><td class="code" id="p75270code8"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">enum</span> CookieType<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, <span style="color: #a61390;">Printable</span> <span style="color: #002200;">{</span>
  ...
  <span style="color: #a61390;">var</span> description<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> spriteName
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<h2>Keeping the Cookies: the 2-D Grid</h2>
<p>Now you need something to hold that 9×9 grid of cookies. The <a href="http://www.raywenderlich.com/66877/how-to-make-a-game-like-candy-crush-part-1" sl-processed="1">Objective-C version</a> of this tutorial did this,</p>

<div class="wp_codebox"><table><tbody><tr id="p752709"><td class="code" id="p75270code9"><pre class="swift" style="font-family:monospace;">Cookie <span style="color: #002200;">*</span>_cookies<span style="color: #002200;">[</span><span style="color: #2400d9;">9</span><span style="color: #002200;">]</span><span style="color: #002200;">[</span><span style="color: #2400d9;">9</span><span style="color: #002200;">]</span>;</pre></td></tr></tbody></table></div>

<p>to create a two-dimensional array of 81 elements. Then you could simply do <code>myCookie = _cookies[3][6];</code> to find the cookie at column 3, row 6.</p>
<p>Swift arrays, however, work quite differently from plain old C arrays and the above is not possible. Fortunately, you can write your own class that acts like a 2-D array and that is just as convenient to use.</p>
<p>Go to <em>File\New\File…</em>, choose the <em>iOS\Source\Swift File</em> template and click <em>Next</em>. Name the file <em>Array2D.swift</em> and click <em>Create</em>.</p>
<p>Replace the contents of <em>Array2D.swift</em> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527010"><td class="code" id="p75270code10"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Array2D&lt;T&gt; <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> columns<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>
  <span style="color: #a61390;">let</span> rows<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>
  <span style="color: #a61390;">var</span> array<span style="color: #002200;">:</span> Array&lt;T?&gt;  <span style="color: #11740a; font-style: italic;">// private</span>
&nbsp;
  <span style="color: #a61390;">init</span><span style="color: #002200;">(</span>columns<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, rows<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">self</span>.columns <span style="color: #002200;">=</span> columns
    <span style="color: #a61390;">self</span>.rows <span style="color: #002200;">=</span> rows
    array <span style="color: #002200;">=</span> Array&lt;T?&gt;<span style="color: #002200;">(</span><span style="color: #a61390;">count</span><span style="color: #002200;">:</span> rows<span style="color: #002200;">*</span>columns, repeatedValue<span style="color: #002200;">:</span> <span style="color: #a61390;">nil</span><span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
&nbsp;
  subscript<span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; T? <span style="color: #002200;">{</span>
    <span style="color: #a61390;">get</span> <span style="color: #002200;">{</span>
      <span style="color: #a61390;">return</span> array<span style="color: #002200;">[</span>row<span style="color: #002200;">*</span>columns <span style="color: #002200;">+</span> column<span style="color: #002200;">]</span>
    <span style="color: #002200;">}</span>
    <span style="color: #a61390;">set</span> <span style="color: #002200;">{</span>
      array<span style="color: #002200;">[</span>row<span style="color: #002200;">*</span>columns <span style="color: #002200;">+</span> column<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> newValue
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>The notation <code>Array2D&lt;T&gt;</code> means that this class is a <i>generic</i>; it can hold elements of any type <code>T</code>. You’ll use <code>Array2D</code> to store <code>Cookie</code> objects, but later on in the tutorial you’ll use another <code>Array2D</code> to store a different type of object, <code>Tile</code>.</p>
<p><code>Array2D</code>‘s initializer creates a regular Swift <code>Array</code> with a count of rows x columns and sets all these elements to nil. When you want a value to be nil in Swift, it needs to be declared optional, which is why the type of the <code>array</code> property is <code>Array&lt;T?&gt;</code> and not just <code>Array&lt;T&gt;</code>.</p>
<p>What makes this class easy to use is that is supports <i>subscripting</i>. If you know the column and row numbers of a specific item, you can index the array as follows: <code>myCookie = cookies[column, row]</code>. Sweet!</p>
<h2>Get Ready, Get Set…</h2>
<p>There is one more helper class you need to write. In Xcode 6 beta 2, Swift does not come with a native <em>set</em> type. A set is a collection, like an array, but it allows each element to appear only once, and it does not store the elements in any particular order.</p>
<p>You could use an <code>NSSet</code> for this purpose, but that doesn’t take advantage of Swift’s strict type checking. Fortunately, it’s not hard to write your own.</p>
<p>Go to <em>File\New\File…</em>, choose the <em>iOS\Source\Swift File</em> template and click <em>Next</em>. Name the file <em>Set.swift</em> and click <em>Create</em>.</p>
<p>Replace the contents of <em>Set.swift</em> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527011"><td class="code" id="p75270code11"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Set&lt;T<span style="color: #002200;">:</span> Hashable&gt;<span style="color: #002200;">:</span> Sequence, <span style="color: #a61390;">Printable</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> dictionary <span style="color: #002200;">=</span> Dictionary&lt;T, Bool&gt;<span style="color: #002200;">(</span><span style="color: #002200;">)</span>  <span style="color: #11740a; font-style: italic;">// private</span>
&nbsp;
  <span style="color: #a61390;">func</span> addElement<span style="color: #002200;">(</span>newElement<span style="color: #002200;">:</span> T<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    dictionary<span style="color: #002200;">[</span>newElement<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">func</span> removeElement<span style="color: #002200;">(</span>element<span style="color: #002200;">:</span> T<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    dictionary<span style="color: #002200;">[</span>element<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> <span style="color: #a61390;">nil</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">func</span> containsElement<span style="color: #002200;">(</span>element<span style="color: #002200;">:</span> T<span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> dictionary<span style="color: #002200;">[</span>element<span style="color: #002200;">]</span> <span style="color: #002200;">!=</span> <span style="color: #a61390;">nil</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">func</span> allElements<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #002200;">[</span>T<span style="color: #002200;">]</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #a61390;">Array</span><span style="color: #002200;">(</span>dictionary.keys<span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">var</span> <span style="color: #a61390;">count</span><span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> dictionary.<span style="color: #a61390;">count</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">func</span> unionSet<span style="color: #002200;">(</span>otherSet<span style="color: #002200;">:</span> Set&lt;T&gt;<span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Set&lt;T&gt; <span style="color: #002200;">{</span>
    <span style="color: #a61390;">var</span> combined <span style="color: #002200;">=</span> Set&lt;T&gt;<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
&nbsp;
    <span style="color: #a61390;">for</span> obj <span style="color: #a61390;">in</span> dictionary.keys <span style="color: #002200;">{</span>
      combined.dictionary<span style="color: #002200;">[</span>obj<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #a61390;">for</span> obj <span style="color: #a61390;">in</span> otherSet.dictionary.keys <span style="color: #002200;">{</span>
      combined.dictionary<span style="color: #002200;">[</span>obj<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #a61390;">return</span> combined
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">func</span> generate<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; IndexingGenerator&lt;Array&lt;T&gt;&gt; <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> allElements<span style="color: #002200;">(</span><span style="color: #002200;">)</span>.generate<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">var</span> description<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> dictionary.description
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>There’s a lot of code here but it’s all quite straightforward. You can add elements to the set, remove elements, and inspect which elements are currently in the set. The <code>unionSet()</code> function is used to combine two sets into a new one.</p>
<p>To guarantee that each element appears only once, <code>Set</code> uses a dictionary. As you probably know, a dictionary stores key-value pairs, and keys must be unique. <code>Set</code> stores its elements as the <i>keys</i> of the dictionary, not as values, guaranteeing that each element appears only once.</p>
<p><code>Set</code> also conforms to the <code>Sequence</code> protocol and implements <code>generate()</code> to return a so-called “generator” object. This allows you to use the set in <code>for-in</code> loops. Very handy!</p>
<h2>The Level Class</h2>
<p>That’s the preliminaries out of the way. Let’s put <code>Array2D</code> and <code>Set</code> to use.</p>
<p>Go to <em>File\New\File…</em>, choose the <em>iOS\Source\Swift File</em> template and click <em>Next</em>. Name the file <em>Level.swift</em> and click <em>Create</em>.</p>
<p>Replace the contents of <em>Level.swift</em> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527012"><td class="code" id="p75270code12"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">import</span> Foundation
&nbsp;
<span style="color: #a61390;">let</span> NumColumns <span style="color: #002200;">=</span> <span style="color: #2400d9;">9</span>
<span style="color: #a61390;">let</span> NumRows <span style="color: #002200;">=</span> <span style="color: #2400d9;">9</span>
&nbsp;
<span style="color: #a61390;">class</span> Level <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> cookies <span style="color: #002200;">=</span> Array2D&lt;Cookie&gt;<span style="color: #002200;">(</span>columns<span style="color: #002200;">:</span> NumColumns, rows<span style="color: #002200;">:</span> NumRows<span style="color: #002200;">)</span>  <span style="color: #11740a; font-style: italic;">// private</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This declares two constants for the dimensions of the level, <code>NumColumns</code> and <code>NumRows</code>, so you don’t have to hardcode the number 9 everywhere.</p>
<p>The property <code>cookies</code> is the two-dimensional array that holds the <code>Cookie</code> objects, 81 in total (9 rows of 9 columns). It is defined with <code>let</code>, not <code>var</code>, because once it’s set the value of <code>cookies</code> never has to change; it will always have the same <code>Array2D</code> instance. </p>
<p>The <code>cookies</code> array is supposed to be private, so <code>Level</code> needs to provide a way for others to obtain a cookie object at a specific position in the level grid. (Note: Swift currently does not support a way to mark properties as private.)</p>
<p>Add the code for this method to <em>Level.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527013"><td class="code" id="p75270code13"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> cookieAtColumn<span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Cookie? <span style="color: #002200;">{</span>
  <span style="color: #a61390;">assert</span><span style="color: #002200;">(</span>column &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> column &lt; NumColumns<span style="color: #002200;">)</span>
  <span style="color: #a61390;">assert</span><span style="color: #002200;">(</span>row &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> row &lt; NumRows<span style="color: #002200;">)</span>
  <span style="color: #a61390;">return</span> cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Using <code>cookieAtColumn(3, row: 6)</code> you can ask the <code>Level</code> for the cookie at column 3, row 6. Behind the scenes this asks the <code>Array2D</code> for the cookie and then returns it. Note that the return type is <code>Cookie?</code>, an optional, because not all grid squares will necessarily have a cookie (they may be nil).</p>
<p>Notice the use of <code>assert()</code> to verify that the specified column and row numbers are within the valid range of 0-8. </p>
<div class="note">
<p><em>Note:</em> New to <code>assert</code>? The idea behind <code>assert</code> is you give it a condition, and if the condition fails the app will crash with a log message.</p>
<p>“Wait a minute,” you may think, “why would I want to crash my app on purpose?!” </p>
<p>Crashing your app on purpose is actually a good thing if you have a condition that you don’t expect to ever happen in your app like this one. <code>assert</code> will help you because when the app crashes, the backtrace will point exactly to this unexpected condition, making it nice and easy  to resolve the source of the problem.</p>
</div>
<p>Now to fill up that <code>cookies</code> array with some cookies! Later on you will learn how to read level designs from a JSON file but for now, you’ll fill up the array yourself, just so there is something to show on the screen. </p>
<p>Add the following two methods to <em>Level.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527014"><td class="code" id="p75270code14"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> shuffle<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Set&lt;Cookie&gt; <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> createInitialCookies<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span>
&nbsp;
<span style="color: #a61390;">func</span> createInitialCookies<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Set&lt;Cookie&gt; <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> <span style="color: #a61390;">set</span> <span style="color: #002200;">=</span> Set&lt;Cookie&gt;<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
&nbsp;
  <span style="color: #11740a; font-style: italic;">// 1</span>
  <span style="color: #a61390;">for</span> row <span style="color: #a61390;">in</span> <span style="color: #2400d9;">0</span>..&lt;NumRows <span style="color: #002200;">{</span>
    <span style="color: #a61390;">for</span> column <span style="color: #a61390;">in</span> <span style="color: #2400d9;">0</span>..&lt;NumColumns <span style="color: #002200;">{</span>
&nbsp;
      <span style="color: #11740a; font-style: italic;">// 2</span>
      <span style="color: #a61390;">var</span> cookieType <span style="color: #002200;">=</span> CookieType.random<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
&nbsp;
      <span style="color: #11740a; font-style: italic;">// 3</span>
      <span style="color: #a61390;">let</span> cookie <span style="color: #002200;">=</span> Cookie<span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> column, row<span style="color: #002200;">:</span> row, cookieType<span style="color: #002200;">:</span> cookieType<span style="color: #002200;">)</span>
      cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> cookie
&nbsp;
      <span style="color: #11740a; font-style: italic;">// 4</span>
      <span style="color: #a61390;">set</span>.addElement<span style="color: #002200;">(</span>cookie<span style="color: #002200;">)</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
  <span style="color: #a61390;">return</span> <span style="color: #a61390;">set</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>(Don’t worry about the error messages on the lines with <code>Set&lt;Cookie&gt;</code>. You’ll fix that in a moment.)</p>
<p>The <code>shuffle</code> method fills up the level with random cookies. Right now it just calls <code>createInitialCookies()</code>, where the real work happens. Here’s what it does, step by step:</p>
<ol>
<li>The method loops through the rows and columns of the 2-D array. This is something you’ll see a lot in this tutorial. Remember that column 0, row 0 is in the bottom-left corner of the 2-D grid.</li>
<li>Then the method picks a random cookie type. This uses the <code>random()</code> function you added to the <code>CookieType</code> enum earlier.</li>
<li>Next, the method creates a new <code>Cookie</code> object and adds it to the 2-D array.</li>
<li>Finally, the method adds the new <code>Cookie</code> object to a <code>Set</code>. <code>shuffle</code> returns this set of cookie objects to its caller.</li>
</ol>
<p>One of the main difficulties when designing your code is deciding how the different objects will communicate with each other. In this game, you often accomplish this by passing around a collection of objects, usually a <code>Set</code> or <code>Array</code>.</p>
<p>In this case, after you create a new <code>Level</code> object and call <code>shuffle</code> to fill it up with cookies, the <code>Level</code> replies, “Here is a set with all the new <code>Cookie</code> objects I just added.” You can take that set and, for example, create new sprites for all the cookie objects it contains. In fact, that’s exactly what you’ll do in the next section.</p>
<p>First, however, there is that error with <code>Set&lt;Cookie&gt;</code>. Because <code>Set</code> stores its elements as dictionary keys, the objects that you put into the set must conform to the <code>Hashable</code> protocol. That’s a requirement for Swift’s dictionary keys. Right now, <code>Cookie</code> does not conform to <code>Hashable</code>, which is why Xcode gets upset.</p>
<p>Switch to <em>Cookie.swift</em> and change the class declaration to include <code>Hashable</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527015"><td class="code" id="p75270code15"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Cookie<span style="color: #002200;">:</span> <span style="color: #a61390;">Printable</span>, Hashable <span style="color: #002200;">{</span></pre></td></tr></tbody></table></div>

<p>Add the following property inside the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527016"><td class="code" id="p75270code16"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> hashValue<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> row<span style="color: #002200;">*</span><span style="color: #2400d9;">10</span> <span style="color: #002200;">+</span> column
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>The <code>Hashable</code> protocol requires that you add a <code>hashValue</code> property to the object. This should return an Int value that is as unique as possible for your object. Its position in the 2-D grid is enough to identify each cookie, and you’ll use that to generate the hash value.</p>
<p>Also add the following function outside the <code>Cookie</code> class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527017"><td class="code" id="p75270code17"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> <span style="color: #002200;">==</span><span style="color: #002200;">(</span>lhs<span style="color: #002200;">:</span> Cookie, rhs<span style="color: #002200;">:</span> Cookie<span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> lhs.column <span style="color: #002200;">==</span> rhs.column <span style="color: #002200;">&amp;&amp;</span> lhs.row <span style="color: #002200;">==</span> rhs.row
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Whenever you add the <code>Hashable</code> protocol to an object, you also need to supply the <code>==</code> comparison operator for comparing two objects of the same type.</p>
<p>Now the errors in <code>Level.swift</code> should be gone. Press <em>Command+B</em> to build the app and make sure you’re no longer getting any compilation errors.</p>
<h2>The Scene and the View Controller</h2>
<p>In many Sprite Kit games, the “scene” is the main object for the game. In Cookie Crunch, however, you’ll make the view controller play that role. </p>
<p>Why? The game will include UIKit elements, such as labels, and it makes sense for the view controller to manage them. You’ll still have a scene object—<code>GameScene</code> from the template—but this will only be responsible for drawing the sprites; it won’t handle any of the game logic. </p>
<p><a href="http://cdn2.raywenderlich.com/wp-content/uploads/2014/06/MVC.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/MVC-700x315.png" alt="MVC" width="700" height="315" class="aligncenter size-large wp-image-75405"></a></p>
<p>Cookie Crunch will use an architecture that is very much like the model-view-controller or MVC pattern that you may know from non-game apps:</p>
<ul>
<li>The data model will consist of <code>Level</code>, <code>Cookie</code> and a few other classes. The models will contain the data, such as the 2-D grid of cookie objects, and handle most of the gameplay logic.</li>
<li>The views will be <code>GameScene</code> and the <code>SKSpriteNodes</code> on the one hand, and <code>UIViews</code> on the other. The views will be responsible for showing things on the screen and for handling touches on those things. The scene in particular will draw the cookie sprites and detect swipes.</li>
<li>The view controller will play the same role here as in a typical MVC app: it will sit between the models and the views and coordinate the whole shebang.</li>
</ul>
<p>All of these objects will communicate with each other, mostly by passing arrays and sets of objects to be modified. This separation will give each object only one job that it can do, totally independent of the others, which will keep the code clean and easy to manage.</p>
<div class="note">
<p><em>Note:</em> Putting the game data and rules in separate model objects is especially useful for unit testing. This tutorial doesn’t cover unit testing but, for a game such as this, it’s a good idea to have a comprehensive set of tests for the game rules.</p>
<p>If game logic and sprites are all mixed up, then it’s hard to write such tests, but in this case you can test <code>Level</code> separate from the other components. This kind of testing lets you add new game rules with confidence you didn’t break any of the existing ones.</p>
</div>
<p>Open <em>GameScene.swift</em> and add the following properties to the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527018"><td class="code" id="p75270code18"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> level<span style="color: #002200;">:</span> Level<span style="color: #002200;">!</span>
&nbsp;
<span style="color: #a61390;">let</span> TileWidth<span style="color: #002200;">:</span> <span style="color: #400080;">CGFloat</span> <span style="color: #002200;">=</span> <span style="color: #2400d9;">32.0</span>
<span style="color: #a61390;">let</span> TileHeight<span style="color: #002200;">:</span> <span style="color: #400080;">CGFloat</span> <span style="color: #002200;">=</span> <span style="color: #2400d9;">36.0</span>
&nbsp;
<span style="color: #a61390;">let</span> gameLayer <span style="color: #002200;">=</span> <span style="color: #400080;">SKNode</span><span style="color: #002200;">(</span><span style="color: #002200;">)</span>
<span style="color: #a61390;">let</span> cookiesLayer <span style="color: #002200;">=</span> <span style="color: #400080;">SKNode</span><span style="color: #002200;">(</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>The scene has a public property to hold a reference to the current level. This variable is marked as <code>Level!</code> because it will not initially have a value.</p>
<p>Each square of the 2-D grid measures 32 by 36 points, so you put those values into the <code>TileWidth</code> and <code>TileHeight</code> constants. These constants will make it easier to calculate the position of a cookie sprite.</p>
<p>To keep the Sprite Kit node hierarchy neatly organized, <code>GameScene</code> uses several layers. The base layer is called <code>gameLayer</code>. This is the container for all the other layers and it’s centered on the screen. You’ll add the cookie sprites to <code>cookiesLayer</code>, which is a child of <code>gameLayer</code>.</p>
<p>Add the following lines to <code>init</code> to add the new layers. Put this after the code that creates the background node:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527019"><td class="code" id="p75270code19"><pre class="swift" style="font-family:monospace;">addChild<span style="color: #002200;">(</span>gameLayer<span style="color: #002200;">)</span>
&nbsp;
<span style="color: #a61390;">let</span> layerPosition <span style="color: #002200;">=</span> <span style="color: #400080;">CGPoint</span><span style="color: #002200;">(</span>
    x<span style="color: #002200;">:</span> <span style="color: #002200;">-</span>TileWidth <span style="color: #002200;">*</span> <span style="color: #400080;">CGFloat</span><span style="color: #002200;">(</span>NumColumns<span style="color: #002200;">)</span> <span style="color: #002200;">/</span> <span style="color: #2400d9;">2</span>,
    y<span style="color: #002200;">:</span> <span style="color: #002200;">-</span>TileHeight <span style="color: #002200;">*</span> <span style="color: #400080;">CGFloat</span><span style="color: #002200;">(</span>NumRows<span style="color: #002200;">)</span> <span style="color: #002200;">/</span> <span style="color: #2400d9;">2</span><span style="color: #002200;">)</span>
&nbsp;
cookiesLayer.position <span style="color: #002200;">=</span> layerPosition
gameLayer.addChild<span style="color: #002200;">(</span>cookiesLayer<span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>This adds two empty <code>SKNode</code>s to the screen to act as layers. You can think of these as transparent planes you can add other nodes in.</p>
<p>Remember that earlier you set the <code>anchorPoint</code> of the scene to (0, 0), and the <code>position</code> of the scene also defaults to (0, 0). This means (0, 0) is in the center of the screen. Therefore, when you add these layers as children of the scene, the point (0, 0) in layer coordinates will also be in the center of the screen.</p>
<p>However, because column 0, row 0 is in the bottom-left corner of the 2-D grid, you want the positions of the sprites to be relative to the <code>cookiesLayer</code>’s bottom-left corner, as well. That’s why you move the layer down and to the left by half the height and width of the grid.</p>
<div class="note">
<p><em>Note:</em> Because <code>NumColumns</code> and <code>NumRows</code> are of type Int but <code>CGPoint</code>‘s <code>x</code> and <code>y</code> fields are of type <code>CGFloat</code>, you have to convert these values by writing <code>CGFloat(NumColumns)</code>. You’ll see this sort of thing a lot in Swift code.</p>
</div>
<p>Adding the sprites to the scene happens in <code>addSpritesForCookies()</code>. Add it below:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527020"><td class="code" id="p75270code20"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> addSpritesForCookies<span style="color: #002200;">(</span>cookies<span style="color: #002200;">:</span> Set&lt;Cookie&gt;<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">for</span> cookie <span style="color: #a61390;">in</span> cookies <span style="color: #002200;">{</span>
    <span style="color: #a61390;">let</span> sprite <span style="color: #002200;">=</span> <span style="color: #400080;">SKSpriteNode</span><span style="color: #002200;">(</span>imageNamed<span style="color: #002200;">:</span> cookie.cookieType.spriteName<span style="color: #002200;">)</span>
    sprite.position <span style="color: #002200;">=</span> pointForColumn<span style="color: #002200;">(</span>cookie.column, row<span style="color: #002200;">:</span>cookie.row<span style="color: #002200;">)</span>
    cookiesLayer.addChild<span style="color: #002200;">(</span>sprite<span style="color: #002200;">)</span>
    cookie.sprite <span style="color: #002200;">=</span> sprite
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span>
&nbsp;
<span style="color: #a61390;">func</span> pointForColumn<span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #400080;">CGPoint</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> <span style="color: #400080;">CGPoint</span><span style="color: #002200;">(</span>
          x<span style="color: #002200;">:</span> <span style="color: #400080;">CGFloat</span><span style="color: #002200;">(</span>column<span style="color: #002200;">)</span><span style="color: #002200;">*</span>TileWidth <span style="color: #002200;">+</span> TileWidth<span style="color: #002200;">/</span><span style="color: #2400d9;">2</span>,
          y<span style="color: #002200;">:</span> <span style="color: #400080;">CGFloat</span><span style="color: #002200;">(</span>row<span style="color: #002200;">)</span><span style="color: #002200;">*</span>TileHeight <span style="color: #002200;">+</span> TileHeight<span style="color: #002200;">/</span><span style="color: #2400d9;">2</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p><code>addSpritesForCookies()</code> iterates through the set of cookies and adds a corresponding <code>SKSpriteNode</code> instance to the cookie layer. This uses a helper method, <code>pointForColumn(column:, row:)</code>, that converts a column and row number into a <code>CGPoint</code> that is relative to the <code>cookiesLayer</code>. This point represents the center of the cookie’s <code>SKSpriteNode</code>.</p>
<p>Hop over to <em>GameViewController.swift</em> and add a new property to the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527021"><td class="code" id="p75270code21"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> level<span style="color: #002200;">:</span> Level<span style="color: #002200;">!</span></pre></td></tr></tbody></table></div>

<p>Next, add these two new methods:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527022"><td class="code" id="p75270code22"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> beginGame<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  shuffle<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span>
&nbsp;
<span style="color: #a61390;">func</span> shuffle<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> newCookies <span style="color: #002200;">=</span> level.shuffle<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
  scene.addSpritesForCookies<span style="color: #002200;">(</span>newCookies<span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p><code>beginGame()</code> kicks off the game by calling <code>shuffle()</code>. This is where you call <code>Level</code>’s <code>shuffle()</code> method, which returns the <code>Set</code> containing new <code>Cookie</code> objects. Remember that these cookie objects are just model data; they don’t have any sprites yet. To show them on the screen, you tell <code>GameScene</code> to add sprites for those cookies.</p>
<p>Make sure you call <code>beginGame()</code> at the end of <code>viewDidLoad</code> to set things in motion:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527023"><td class="code" id="p75270code23"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> viewDidLoad<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
   ...
   beginGame<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>The only missing piece is creating the actual <code>Level</code> instance. That also happens in <code>viewDidLoad()</code>. Add the following lines just before the code that presents the scene:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527024"><td class="code" id="p75270code24"><pre class="swift" style="font-family:monospace;">level <span style="color: #002200;">=</span> Level<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
scene.level <span style="color: #002200;">=</span> level</pre></td></tr></tbody></table></div>

<p>After creating the new <code>Level</code> instance, you set the <code>level</code> property on the scene to tie together the model and the view.</p>
<div class="note">
<p><em>Note:</em> The reason you declared the <code>var level</code> property as <code>Level!</code>, with an exclamation point, is that all properties must have a value by the time the class is initialized. But you can’t give <code>level</code> a value in <code>init()</code> yet; that doesn’t happen until <code>viewDidLoad</code>. With the <code>!</code> you tell Swift that this variable won’t have a value until later (but once it’s set, it can never become nil again).</p>
</div>
<p>Build and run, and you should finally see some cookies:</p>
<p><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2014/02/First-cookies.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/First-cookies-301x500.png" alt="First cookies" width="301" height="500" class="aligncenter size-large wp-image-66887"></a></p>
<h2>Loading Levels from JSON Files</h2>
<p>Not all the levels in <i>Candy Crush Saga</i> have grids that are a simple square shape. You will now add support for loading level designs from JSON files. The five designs you’re going to load still use the same 9×9 grid, but they leave some of the squares blank.</p>
<p>Drag the <em>Levels</em> folder from the tutorial’s Resources folder into your Xcode project. As always, make sure <em>Destination: Copy items if needed</em> is checked. This folder contains five JSON files:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Levels-in-project-navigator.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Levels-in-project-navigator.png" alt="Levels in project navigator" width="259" height="146" class="aligncenter size-full wp-image-75402"></a></p>
<p>Click on <em>Level_1.json</em> to look inside. You’ll see that the contents are structured as a dictionary containing three elements: <code>tiles</code>, <code>targetScore</code> and <code>moves</code>. </p>
<p>The <code>tiles</code> array contains nine other arrays, one for each row of the level. If a tile has a value of <em>1</em>, it can contain a cookie; a <em>0</em> means the tile is empty.</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Level_1-json.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Level_1-json.png" alt="Level_1 json" width="457" height="262" class="aligncenter size-full wp-image-66893"></a></p>
<p>You’ll load this data in <code>Level</code>, but first you need to add a new class, <code>Tile</code>, to represent a single tile in the 2-D level grid. Note that a tile is different than a cookie — think of tiles as “slots”, and of cookies as the things inside the slots. I’ll discuss more about this in a bit.</p>
<p>Add a new <em>Swift File</em> to the project. Name it <em>Tile.swift</em>. Replace the contents of this file with:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527025"><td class="code" id="p75270code25"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Tile <span style="color: #002200;">{</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>You can leave this new class empty right now. Later on, I’ll give you some hints for how to use this class to add additional features to the game, such as “jelly” tiles.</p>
<p>Open <em>Level.swift</em> and add a new property and method:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527026"><td class="code" id="p75270code26"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">let</span> tiles <span style="color: #002200;">=</span> Array2D&lt;Tile&gt;<span style="color: #002200;">(</span>columns<span style="color: #002200;">:</span> NumColumns, rows<span style="color: #002200;">:</span> NumRows<span style="color: #002200;">)</span>  <span style="color: #11740a; font-style: italic;">// private</span>
&nbsp;
<span style="color: #a61390;">func</span> tileAtColumn<span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Tile? <span style="color: #002200;">{</span>
  <span style="color: #a61390;">assert</span><span style="color: #002200;">(</span>column &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> column &lt; NumColumns<span style="color: #002200;">)</span>
  <span style="color: #a61390;">assert</span><span style="color: #002200;">(</span>row &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> row &lt; NumRows<span style="color: #002200;">)</span>
  <span style="color: #a61390;">return</span> tiles<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>The <code>tiles</code> variable describes the structure of the level. This is very similar to the <code>cookies</code> array, except now you make it an <code>Array2D</code> of <code>Tile</code> objects.</p>
<p>Whereas the <code>cookies</code> array keeps track of the <code>Cookie</code> objects in the level, <code>tiles</code> simply describes which parts of the level grid are empty and which can contain a cookie:</p>
<p><a href="http://cdn3.raywenderlich.com/wp-content/uploads/2014/02/JSON-and-tiles.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/JSON-and-tiles-480x185.png" alt="JSON and tiles" width="480" height="185" class="aligncenter size-medium wp-image-66892"></a></p>
<p>Wherever <code>tiles[a, b]</code> is <code>nil</code>, the grid is empty and <i>cannot</i> contain a cookie.</p>
<p>Now that the instance variables for level data are in place, you can start adding the code to fill in the data. The top-level item in the JSON file is a dictionary, so it makes sense to add the code for loading the JSON file to Swift’s <code>Dictionary</code>.</p>
<p>Go to <em>File\New\File…</em>, choose the <em>iOS\Source\Swift File</em> template and click <em>Next</em>. Name the file <em>Extensions.swift</em> and click <em>Create</em>.</p>
<p>Add the following code in <em>Extensions.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527027"><td class="code" id="p75270code27"><pre class="swift" style="font-family:monospace;">extension <span style="color: #a61390;">Dictionary</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">static</span> <span style="color: #a61390;">func</span> loadJSONFromBundle<span style="color: #002200;">(</span>filename<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Dictionary&lt;String, AnyObject&gt;? <span style="color: #002200;">{</span>
    <span style="color: #a61390;">let</span> path <span style="color: #002200;">=</span> <span style="color: #400080;">NSBundle</span>.mainBundle<span style="color: #002200;">(</span><span style="color: #002200;">)</span>.pathForResource<span style="color: #002200;">(</span>filename, ofType<span style="color: #002200;">:</span> <span style="color: #bf1d1a;">"json"</span><span style="color: #002200;">)</span>
    <span style="color: #a61390;">if</span> <span style="color: #002200;">!</span>path <span style="color: #002200;">{</span>
      <span style="color: #a61390;">println</span><span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Could not find level file: <span style="color: #2400d9;">\(</span>filename)"</span><span style="color: #002200;">)</span>
      <span style="color: #a61390;">return</span> <span style="color: #a61390;">nil</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #a61390;">var</span> error<span style="color: #002200;">:</span> <span style="color: #400080;">NSError</span>?
    <span style="color: #a61390;">let</span> data<span style="color: #002200;">:</span> <span style="color: #400080;">NSData</span>? <span style="color: #002200;">=</span> <span style="color: #400080;">NSData</span><span style="color: #002200;">(</span>contentsOfFile<span style="color: #002200;">:</span> path, options<span style="color: #002200;">:</span> NSDataReadingOptions<span style="color: #002200;">(</span><span style="color: #002200;">)</span>, 
                               error<span style="color: #002200;">:</span> <span style="color: #002200;">&amp;</span>error<span style="color: #002200;">)</span>
    <span style="color: #a61390;">if</span> <span style="color: #002200;">!</span>data <span style="color: #002200;">{</span>
      <span style="color: #a61390;">println</span><span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Could not load level file: <span style="color: #2400d9;">\(</span>filename), error: <span style="color: #2400d9;">\(</span>error!)"</span><span style="color: #002200;">)</span>
      <span style="color: #a61390;">return</span> <span style="color: #a61390;">nil</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #a61390;">let</span> dictionary<span style="color: #002200;">:</span> <span style="color: #a61390;">AnyObject</span><span style="color: #002200;">!</span> <span style="color: #002200;">=</span> <span style="color: #400080;">NSJSONSerialization</span>.JSONObjectWithData<span style="color: #002200;">(</span>data, 
                                     options<span style="color: #002200;">:</span> NSJSONReadingOptions<span style="color: #002200;">(</span><span style="color: #002200;">)</span>, error<span style="color: #002200;">:</span> <span style="color: #002200;">&amp;</span>error<span style="color: #002200;">)</span>
    <span style="color: #a61390;">if</span> <span style="color: #002200;">!</span>dictionary <span style="color: #002200;">{</span>
      <span style="color: #a61390;">println</span><span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Level file '<span style="color: #2400d9;">\(</span>filename)' is not valid JSON: <span style="color: #2400d9;">\(</span>error!)"</span><span style="color: #002200;">)</span>
      <span style="color: #a61390;">return</span> <span style="color: #a61390;">nil</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #a61390;">return</span> dictionary <span style="color: #a61390;">as?</span> Dictionary&lt;String, AnyObject&gt;
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Using Swift’s extension mechanism you can add new methods to existing types. Here you have added <code>loadJSONFromBundle()</code> to load a JSON file from the app bundle, into a new dictionary of type <code>Dictionary&lt;String, AnyObject&gt;</code>. This means the dictionary’s keys are always strings but the associated values can be any type of object.</p>
<p>The method simply loads the specified file into an <code>NSData</code> object and then converts that to a <code>Dictionary</code> using the <code>NSJSONSerialization</code> API. This is mostly boilerplate code that you’ll find in any app that deals with JSON files.</p>
<div class="note">
<p><em>Note:</em> To learn more about JSON and parsing it in iOS, check out our <a href="http://www.raywenderlich.com/5492/working-with-json-in-ios-5" sl-processed="1">Working with JSON Tutorial</a>.</p>
</div>
<p>Next, add the new <code>init(filename:)</code> initializer to <em>Level.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527028"><td class="code" id="p75270code28"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">init</span><span style="color: #002200;">(</span>filename<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #11740a; font-style: italic;">// 1 </span>
  <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> dictionary <span style="color: #002200;">=</span> Dictionary&lt;String, AnyObject&gt;.loadJSONFromBundle<span style="color: #002200;">(</span>filename<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #11740a; font-style: italic;">// 2</span>
    <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> tilesArray<span style="color: #002200;">:</span> <span style="color: #a61390;">AnyObject</span> <span style="color: #002200;">=</span> dictionary<span style="color: #002200;">[</span><span style="color: #bf1d1a;">"tiles"</span><span style="color: #002200;">]</span> <span style="color: #002200;">{</span>
      <span style="color: #11740a; font-style: italic;">// 3</span>
      <span style="color: #a61390;">for</span> <span style="color: #002200;">(</span>row, rowArray<span style="color: #002200;">)</span> <span style="color: #a61390;">in</span> <span style="color: #a61390;">enumerate</span><span style="color: #002200;">(</span>tilesArray <span style="color: #a61390;">as</span> <span style="color: #002200;">[</span><span style="color: #002200;">[</span><span style="color: #a61390;">Int</span><span style="color: #002200;">]</span><span style="color: #002200;">]</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
        <span style="color: #11740a; font-style: italic;">// 4</span>
        <span style="color: #a61390;">let</span> tileRow <span style="color: #002200;">=</span> NumRows <span style="color: #002200;">-</span> row <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span>
        <span style="color: #11740a; font-style: italic;">// 5</span>
        <span style="color: #a61390;">for</span> <span style="color: #002200;">(</span>column, value<span style="color: #002200;">)</span> <span style="color: #a61390;">in</span> <span style="color: #a61390;">enumerate</span><span style="color: #002200;">(</span>rowArray<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
          <span style="color: #a61390;">if</span> value <span style="color: #002200;">==</span> <span style="color: #2400d9;">1</span> <span style="color: #002200;">{</span>
            tiles<span style="color: #002200;">[</span>column, tileRow<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> Tile<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
          <span style="color: #002200;">}</span>
        <span style="color: #002200;">}</span>
      <span style="color: #002200;">}</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Here’s what this initializer does, step-by-step:</p>
<ol>
<li>Load the named file into a <code>Dictionary</code> using the <code>loadJSONFromBundle()</code> helper function that you just added. Note that this function may return nil — it returns an optional — and you must use <i>optional binding</i> to handle this situation.</li>
<li>The dictionary has an array named “tiles”. This array contains one element for each row of the level. Each of those row elements is itself an array containing the columns for that row. The type of <code>tilesArray</code> is therefore array-of-array-of-Int, or <code>[[Int]]</code>.</li>
<li>Step through the rows using built-in <code>enumerate()</code> function, which is useful because it also returns the current row number.</li>
<li>In Sprite Kit (0, 0) is at the bottom of the screen, so you have to reverse the order of the rows here. The first row you read from the JSON corresponds to the last row of the 2-D grid.</li>
<li>Step through the columns in the current row. Every time it finds a 1, it creates a <code>Tile</code> object and places it into the <code>tiles</code> array.</li>
</ol>
<p>At this point, the code will compile without errors but you still need to put this new <code>tiles</code> array to good use. Inside <code>createInitialCookies()</code>, add an if-clause inside the two for-loops, around the code that creates the <code>Cookie</code> object:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527029"><td class="code" id="p75270code29"><pre class="swift" style="font-family:monospace;"><span style="color: #11740a; font-style: italic;">// This line is new</span>
<span style="color: #a61390;">if</span> tiles<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">{</span>
&nbsp;
  <span style="color: #a61390;">var</span> cookieType <span style="color: #002200;">=</span> ...
  ...
  <span style="color: #a61390;">set</span>.addElement<span style="color: #002200;">(</span>cookie<span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Now the app will only create a <code>Cookie</code> object if there is a tile at that spot.</p>
<p>One last thing remains: In <em>GameViewController.swift</em>’s <code>viewDidLoad()</code>, replace the line that creates the level object with:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527030"><td class="code" id="p75270code30"><pre class="swift" style="font-family:monospace;">level <span style="color: #002200;">=</span> Level<span style="color: #002200;">(</span>filename<span style="color: #002200;">:</span> <span style="color: #bf1d1a;">"Level_1"</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>Build and run, and now you should have a non-square level shape:</p>
<p><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2014/02/Non-square-level.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Non-square-level-301x500.png" alt="Non-square level" width="301" height="500" class="aligncenter size-large wp-image-66898"></a></p>
<h2>Making the Tiles Visible</h2>
<p>To make the cookie sprites stand out from the background a bit more, you can draw a slightly darker “tile” sprite behind each cookie. The texture atlas already contains an image for this (<em>Tile.png</em>). These new tile sprites will live on their own layer, the <code>tilesLayer</code>. </p>
<p>To do this, first add a new private property to <em>GameScene.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527031"><td class="code" id="p75270code31"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">let</span> tilesLayer <span style="color: #002200;">=</span> <span style="color: #400080;">SKNode</span><span style="color: #002200;">(</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>Then add this code to <code>init(size:)</code>, right above where you add the <code>cookiesLayer</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527032"><td class="code" id="p75270code32"><pre class="swift" style="font-family:monospace;">tilesLayer.position <span style="color: #002200;">=</span> layerPosition
gameLayer.addChild<span style="color: #002200;">(</span>tilesLayer<span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>It needs to be done first so the tiles appear behind the cookies (Sprite Kit nodes with the same <code>zPosition</code> are drawn in order of how they were added).</p>
<p>Add the following method to <em>GameScene.swift</em>, as well:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527033"><td class="code" id="p75270code33"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> addTiles<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">for</span> row <span style="color: #a61390;">in</span> <span style="color: #2400d9;">0</span>..&lt;NumRows <span style="color: #002200;">{</span>
    <span style="color: #a61390;">for</span> column <span style="color: #a61390;">in</span> <span style="color: #2400d9;">0</span>..&lt;NumColumns <span style="color: #002200;">{</span>
      <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> tile <span style="color: #002200;">=</span> level.tileAtColumn<span style="color: #002200;">(</span>column, row<span style="color: #002200;">:</span> row<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
        <span style="color: #a61390;">let</span> tileNode <span style="color: #002200;">=</span> <span style="color: #400080;">SKSpriteNode</span><span style="color: #002200;">(</span>imageNamed<span style="color: #002200;">:</span> <span style="color: #bf1d1a;">"Tile"</span><span style="color: #002200;">)</span>
        tileNode.position <span style="color: #002200;">=</span> pointForColumn<span style="color: #002200;">(</span>column, row<span style="color: #002200;">:</span> row<span style="color: #002200;">)</span>
        tilesLayer.addChild<span style="color: #002200;">(</span>tileNode<span style="color: #002200;">)</span>
      <span style="color: #002200;">}</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This loops through all the rows and columns. If there is a tile at that grid square, then it creates a new tile sprite and adds it to the tiles layer.</p>
<p>Next, open <em>GameViewController.swift</em>. Add the following line to <code>viewDidLoad()</code>, immediately after you set <code>scene.level</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527034"><td class="code" id="p75270code34"><pre class="swift" style="font-family:monospace;">scene.addTiles<span style="color: #002200;">(</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>Build and run, and you can clearly see where the tiles are:</p>
<p><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2014/02/Tiles-layer.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Tiles-layer-301x500.png" alt="Tiles layer" width="301" height="500" class="aligncenter size-large wp-image-66903"></a></p>
<p>You can switch to another level design by specifying a different file name in <code>viewDidLoad()</code>. Simply change the <code>filename:</code> parameter to “Level_2″, “Level_3″ or “Level_4″ and build and run. Does Level 3 remind you of anything? :]</p>
<p>Feel free to make your own designs, too! Just remember that the “tiles” array should contain nine arrays (one for each row), with nine numbers each (one for each column).</p>
<h2>Swiping to Swap Cookies</h2>
<p>In Cookie Crunch Adventure, you want the player to be able to swap two cookies by swiping left, right, up or down. </p>
<p>Detecting swipes is a job for <code>GameScene</code>. If the player touches a cookie on the screen, then this might be the start of a valid swipe motion. Which cookie to swap with the touched cookie depends on the direction of the swipe.</p>
<p>To recognize the swipe motion, you’ll use the <code>touchesBegan</code>, <code>touchesMoved</code> and <code>touchesEnded</code> methods from <code>GameScene</code>. Even though iOS has very handy pan and swipe gesture recognizers, these don’t provide the level of accuracy and control that this game needs.</p>
<p>Go to <em>GameScene.swift</em> and add two private properties to the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527035"><td class="code" id="p75270code35"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> swipeFromColumn<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>?
<span style="color: #a61390;">var</span> swipeFromRow<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>?</pre></td></tr></tbody></table></div>

<p>These properties record the column and row numbers of the cookie that the player first touched when she started her swipe movement.</p>
<p>Initialize these two properties at the bottom of <code>init(size:)</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527036"><td class="code" id="p75270code36"><pre class="swift" style="font-family:monospace;">swipeFromColumn <span style="color: #002200;">=</span> <span style="color: #a61390;">nil</span>
swipeFromRow <span style="color: #002200;">=</span> <span style="color: #a61390;">nil</span></pre></td></tr></tbody></table></div>

<p>The value <code>nil</code> means that these properties have invalid values. In other words, they don’t yet point at any of the cookies. This is why they are declared as optionals — <code>Int?</code> instead of just <code>Int</code> — because they need to be nil when the player is not swiping.</p>
<p>Now add a new method <code>touchesBegan()</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527037"><td class="code" id="p75270code37"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> touchesBegan<span style="color: #002200;">(</span>touches<span style="color: #002200;">:</span> <span style="color: #400080;">NSSet</span><span style="color: #002200;">!</span>, withEvent event<span style="color: #002200;">:</span> <span style="color: #400080;">UIEvent</span><span style="color: #002200;">!</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #11740a; font-style: italic;">// 1</span>
  <span style="color: #a61390;">let</span> touch <span style="color: #002200;">=</span> touches.anyObject<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #a61390;">as</span> UITouch
  <span style="color: #a61390;">let</span> location <span style="color: #002200;">=</span> touch.locationInNode<span style="color: #002200;">(</span>cookiesLayer<span style="color: #002200;">)</span>
  <span style="color: #11740a; font-style: italic;">// 2</span>
  <span style="color: #a61390;">let</span> <span style="color: #002200;">(</span>success, column, row<span style="color: #002200;">)</span> <span style="color: #002200;">=</span> convertPoint<span style="color: #002200;">(</span>location<span style="color: #002200;">)</span>
  <span style="color: #a61390;">if</span> success <span style="color: #002200;">{</span>
    <span style="color: #11740a; font-style: italic;">// 3</span>
    <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> cookie <span style="color: #002200;">=</span> level.cookieAtColumn<span style="color: #002200;">(</span>column, row<span style="color: #002200;">:</span> row<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
      <span style="color: #11740a; font-style: italic;">// 4</span>
      swipeFromColumn <span style="color: #002200;">=</span> column
      swipeFromRow <span style="color: #002200;">=</span> row
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<div class="note">
<p><em>Note:</em> This method needs to be marked <code>override</code> because the base class <code>SKScene</code> already contains a version of <code>touchesBegan</code>. This is how you tell Swift that you want it to use your own version.</p>
</div>
<p>The game will call <code>touchesBegan()</code> whenever the user puts her finger on the screen. Here’s what the method does, step by step:</p>
<ol>
<li>It converts the touch location to a point relative to the <code>cookiesLayer</code>.</li>
<li>Then, it finds out if the touch is inside a square on the level grid by calling a method you’ll write in a moment. If so, then this might be the start of a swipe motion. At this point, you don’t know yet whether that square contains a cookie, but at least the player put her finger somewhere inside the 9×9 grid.</li>
<li>Next, the method verifies that the touch is on a cookie rather than on an empty square.</li>
<li>Finally, it records the column and row where the swipe started so you can compare them later to find the direction of the swipe.</li>
</ol>
<p>The <code>convertPoint()</code> method is new. It’s the opposite of <code>pointForColumn(column:, row:)</code>, so you may want to add this method right below <code>pointForColumn()</code> so the two methods are nearby.</p>

<div class="wp_codebox"><table><tbody><tr id="p7527038"><td class="code" id="p75270code38"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> convertPoint<span style="color: #002200;">(</span>point<span style="color: #002200;">:</span> <span style="color: #400080;">CGPoint</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #002200;">(</span>success<span style="color: #002200;">:</span> <span style="color: #a61390;">Bool</span>, column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">if</span> point.x &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> point.x &lt; <span style="color: #400080;">CGFloat</span><span style="color: #002200;">(</span>NumColumns<span style="color: #002200;">)</span><span style="color: #002200;">*</span>TileWidth <span style="color: #002200;">&amp;&amp;</span>
     point.y &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> point.y &lt; <span style="color: #400080;">CGFloat</span><span style="color: #002200;">(</span>NumRows<span style="color: #002200;">)</span><span style="color: #002200;">*</span>TileHeight <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #002200;">(</span><span style="color: #a61390;">true</span>, <span style="color: #a61390;">Int</span><span style="color: #002200;">(</span>point.x <span style="color: #002200;">/</span> TileWidth<span style="color: #002200;">)</span>, <span style="color: #a61390;">Int</span><span style="color: #002200;">(</span>point.y <span style="color: #002200;">/</span> TileHeight<span style="color: #002200;">)</span><span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #002200;">(</span><span style="color: #a61390;">false</span>, <span style="color: #2400d9;">0</span>, <span style="color: #2400d9;">0</span><span style="color: #002200;">)</span>  <span style="color: #11740a; font-style: italic;">// invalid location</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This method takes a <code>CGPoint</code> that is relative to the <code>cookiesLayer</code> and converts it into column and row numbers. The return value of this method is a <i>tuple</i> with three values: 1) the boolean that indicates success or failure; 2) the column number; and 3) the row number. If the point falls outside the grid, this method returns <code>false</code> for success.</p>
<p>So far, you have detected the start of a possible swipe motion. To perform a valid swipe, the player also has to move her finger out of the current square. It doesn’t really matter where the finger ends up—you’re only interested in the general direction of the swipe, not the exact destination.</p>
<p>The logic for detecting the swipe direction goes into <code>touchesMoved()</code>, so add this method next:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527039"><td class="code" id="p75270code39"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> touchesMoved<span style="color: #002200;">(</span>touches<span style="color: #002200;">:</span> <span style="color: #400080;">NSSet</span><span style="color: #002200;">!</span>, withEvent event<span style="color: #002200;">:</span> <span style="color: #400080;">UIEvent</span><span style="color: #002200;">!</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #11740a; font-style: italic;">// 1</span>
  <span style="color: #a61390;">if</span> swipeFromColumn <span style="color: #002200;">==</span> <span style="color: #a61390;">nil</span> <span style="color: #002200;">{</span> <span style="color: #a61390;">return</span> <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #11740a; font-style: italic;">// 2</span>
  <span style="color: #a61390;">let</span> touch <span style="color: #002200;">=</span> touches.anyObject<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #a61390;">as</span> UITouch
  <span style="color: #a61390;">let</span> location <span style="color: #002200;">=</span> touch.locationInNode<span style="color: #002200;">(</span>cookiesLayer<span style="color: #002200;">)</span>
&nbsp;
  <span style="color: #a61390;">let</span> <span style="color: #002200;">(</span>success, column, row<span style="color: #002200;">)</span> <span style="color: #002200;">=</span> convertPoint<span style="color: #002200;">(</span>location<span style="color: #002200;">)</span>
  <span style="color: #a61390;">if</span> success <span style="color: #002200;">{</span>
&nbsp;
    <span style="color: #11740a; font-style: italic;">// 3</span>
    <span style="color: #a61390;">var</span> horzDelta <span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span>, vertDelta <span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span>
    <span style="color: #a61390;">if</span> column &lt; swipeFromColumn<span style="color: #002200;">!</span> <span style="color: #002200;">{</span>          <span style="color: #11740a; font-style: italic;">// swipe left</span>
      horzDelta <span style="color: #002200;">=</span> <span style="color: #002200;">-</span><span style="color: #2400d9;">1</span>
    <span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #a61390;">if</span> column &gt; swipeFromColumn<span style="color: #002200;">!</span> <span style="color: #002200;">{</span>   <span style="color: #11740a; font-style: italic;">// swipe right</span>
      horzDelta <span style="color: #002200;">=</span> <span style="color: #2400d9;">1</span>
    <span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #a61390;">if</span> row &lt; swipeFromRow<span style="color: #002200;">!</span> <span style="color: #002200;">{</span>         <span style="color: #11740a; font-style: italic;">// swipe down</span>
      vertDelta <span style="color: #002200;">=</span> <span style="color: #002200;">-</span><span style="color: #2400d9;">1</span>
    <span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #a61390;">if</span> row &gt; swipeFromRow<span style="color: #002200;">!</span> <span style="color: #002200;">{</span>         <span style="color: #11740a; font-style: italic;">// swipe up</span>
      vertDelta <span style="color: #002200;">=</span> <span style="color: #2400d9;">1</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #11740a; font-style: italic;">// 4</span>
    <span style="color: #a61390;">if</span> horzDelta <span style="color: #002200;">!=</span> <span style="color: #2400d9;">0</span> || vertDelta <span style="color: #002200;">!=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">{</span>
      trySwapHorizontal<span style="color: #002200;">(</span>horzDelta, vertical<span style="color: #002200;">:</span> vertDelta<span style="color: #002200;">)</span>
&nbsp;
      <span style="color: #11740a; font-style: italic;">// 5</span>
      swipeFromColumn <span style="color: #002200;">=</span> <span style="color: #a61390;">nil</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Here is what this does step by step:</p>
<ol>
<li>If <code>swipeFromColumn</code> is <code>nil</code>, then either the swipe began outside the valid area or the game has already swapped the cookies and you need to ignore the rest of the motion. You could keep track of this in a separate boolean but using <code>swipeFromColumn</code> is just as easy — that’s why you made it an optional.</li>
<li>This is similar to what <code>touchesBegan()</code> does to calculate the row and column numbers currently under the player’s finger.</li>
<li>Here the method figures out the direction of the player’s swipe by simply comparing the new column and row numbers to the previous ones. Note that you’re not allowing diagonal swipes (since you’re using <code>else if</code> statements, only one of <code>horzDelta</code> or <code>vertDelta</code> will be set).</li>
<li>The method only performs the swap if the player swiped out of the old square.</li>
<li>By setting <code>swipeFromColumn</code> back to <code>nil</code>, the game will ignore the rest of this swipe motion.</li>
</ol>
<div class="note">
<p><em>Note:</em> To read the actual values from <code>swipeFromColumn</code> and <code>swipeFromRow</code>, you have to use the exclamation point. These are optional variables, and using the <code>!</code> will “unwrap” the optional. Normally you’d use optional binding to read the value of an optional but here you’re guaranteed that <code>swipeFromRow</code> is not nil (you checked for that at the top of the method), so using <code>!</code> is perfectly safe.</p>
</div>
<p>The hard work of cookie-swapping goes into a new method:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527040"><td class="code" id="p75270code40"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> trySwapHorizontal<span style="color: #002200;">(</span>horzDelta<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, vertical vertDelta<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #11740a; font-style: italic;">// 1</span>
  <span style="color: #a61390;">let</span> toColumn <span style="color: #002200;">=</span> swipeFromColumn<span style="color: #002200;">!</span> <span style="color: #002200;">+</span> horzDelta
  <span style="color: #a61390;">let</span> toRow <span style="color: #002200;">=</span> swipeFromRow<span style="color: #002200;">!</span> <span style="color: #002200;">+</span> vertDelta
  <span style="color: #11740a; font-style: italic;">// 2</span>
  <span style="color: #a61390;">if</span> toColumn &lt; <span style="color: #2400d9;">0</span> || toColumn &gt;<span style="color: #002200;">=</span> NumColumns <span style="color: #002200;">{</span> <span style="color: #a61390;">return</span> <span style="color: #002200;">}</span>
  <span style="color: #a61390;">if</span> toRow &lt; <span style="color: #2400d9;">0</span> || toRow &gt;<span style="color: #002200;">=</span> NumRows <span style="color: #002200;">{</span> <span style="color: #a61390;">return</span> <span style="color: #002200;">}</span>
  <span style="color: #11740a; font-style: italic;">// 3</span>
  <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> toCookie <span style="color: #002200;">=</span> level.cookieAtColumn<span style="color: #002200;">(</span>toColumn, row<span style="color: #002200;">:</span> toRow<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> fromCookie <span style="color: #002200;">=</span> level.cookieAtColumn<span style="color: #002200;">(</span>swipeFromColumn<span style="color: #002200;">!</span>, row<span style="color: #002200;">:</span> swipeFromRow<span style="color: #002200;">!</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
      <span style="color: #11740a; font-style: italic;">// 4</span>
      <span style="color: #a61390;">println</span><span style="color: #002200;">(</span><span style="color: #bf1d1a;">"*** swapping <span style="color: #2400d9;">\(</span>fromCookie) with <span style="color: #2400d9;">\(</span>toCookie)"</span><span style="color: #002200;">)</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This is called “<i>try</i> swap” for a reason. At this point, you only know that the player swiped up, down, left or right, but you don’t yet know if there are two cookies to swap in that direction.</p>
<ol>
<li>You calculate the column and row numbers of the cookie to swap with.</li>
<li>It is possible that the <code>toColumn</code> or <code>toRow</code> is outside the 9×9 grid. This can occur when the user swipes from a cookie near the edge of the grid. The game should ignore such swipes.</li>
<li>The final check is to make sure that there is actually a cookie at the new position. You can’t swap if there’s no second cookie. This happens when the user swipes into a gap where there is no tile.</li>
<li>When you get here, it means everything is OK and this is a valid swap! For now, you log both cookies to the Xcode debug pane.</li>
</ol>
<p>For completeness’s sake, you should also implement <code>touchesEnded()</code>, which is called when the user lifts her finger from the screen, and <code>touchesCancelled()</code>, which happens when iOS decides that it must interrupt the touch (for example, because of an incoming phone call).</p>
<p>Add the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527041"><td class="code" id="p75270code41"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> touchesEnded<span style="color: #002200;">(</span>touches<span style="color: #002200;">:</span> <span style="color: #400080;">NSSet</span><span style="color: #002200;">!</span>, withEvent event<span style="color: #002200;">:</span> <span style="color: #400080;">UIEvent</span><span style="color: #002200;">!</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  swipeFromColumn <span style="color: #002200;">=</span> <span style="color: #a61390;">nil</span>
  swipeFromRow <span style="color: #002200;">=</span> <span style="color: #a61390;">nil</span>
<span style="color: #002200;">}</span>
&nbsp;
<span style="color: #a61390;">override</span> <span style="color: #a61390;">func</span> touchesCancelled<span style="color: #002200;">(</span>touches<span style="color: #002200;">:</span> <span style="color: #400080;">NSSet</span><span style="color: #002200;">!</span>, withEvent event<span style="color: #002200;">:</span> <span style="color: #400080;">UIEvent</span><span style="color: #002200;">!</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  touchesEnded<span style="color: #002200;">(</span>touches, withEvent<span style="color: #002200;">:</span> event<span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>If the gesture ends, regardless of whether it was a valid swipe, you reset the starting column and row numbers to the special value <code>nil</code>.</p>
<p>Great! Build and run, and try out different swaps:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Valid-swap.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Valid-swap.png" alt="Valid swap" width="384" height="296" class="aligncenter size-full wp-image-66904"></a></p>
<p>Of course, you won’t see anything happen in the game yet, but at least the debug pane logs your attempts to make a valid swap.</p>
<h2>Animating the Swaps</h2>
<p>To describe the swapping of two cookies, you will create a new class, <code>Swap</code>. This is another model class whose only purpose it is to say, “The player wants to swap cookie A with cookie B.”</p>
<p>Create a new <em>Swift File</em> named <em>Swap.swift</em>. Replace the contents of <em>Swap.swift</em> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527042"><td class="code" id="p75270code42"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Swap<span style="color: #002200;">:</span> <span style="color: #a61390;">Printable</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> cookieA<span style="color: #002200;">:</span> Cookie
  <span style="color: #a61390;">var</span> cookieB<span style="color: #002200;">:</span> Cookie
&nbsp;
  <span style="color: #a61390;">init</span><span style="color: #002200;">(</span>cookieA<span style="color: #002200;">:</span> Cookie, cookieB<span style="color: #002200;">:</span> Cookie<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">self</span>.cookieA <span style="color: #002200;">=</span> cookieA
    <span style="color: #a61390;">self</span>.cookieB <span style="color: #002200;">=</span> cookieB
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">var</span> description<span style="color: #002200;">:</span> <span style="color: #a61390;">String</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">return</span> <span style="color: #bf1d1a;">"swap <span style="color: #2400d9;">\(</span>cookieA) with <span style="color: #2400d9;">\(</span>cookieB)"</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Now that you have an object that can describe an attempted swap, the question becomes: Who will handle the logic of actually performing the swap? The swipe detection logic happens in <code>GameScene</code>, but all the real game logic so far is in <code>GameViewController</code>.</p>
<p>That means <code>GameScene</code> must have a way to communicate back to <code>GameViewController</code> that the player performed a valid swipe and that a swap must be attempted. One way to communicate is through a delegate protocol, but since this is the only message that <code>GameScene</code> must send back to <code>GameViewController</code>, you’ll use a closure instead.</p>
<p>Add the following property to the top of <em>GameScene.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527043"><td class="code" id="p75270code43"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> swipeHandler<span style="color: #002200;">:</span> <span style="color: #002200;">(</span><span style="color: #002200;">(</span>Swap<span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #002200;">(</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span>?</pre></td></tr></tbody></table></div>

<p>That looks scary… The type of this variable is <code>((Swap) -&gt; ())?</code>. Because of the <code>-&gt;</code> you can tell this is a closure or function. This closure or function takes a <code>Swap</code> object as its parameter and does not return anything. The question mark indicates that <code>swipeHandler</code> is allowed to be nil (it is an optional).</p>
<p>It’s the scene’s job to handle touches. If it recognizes that the user made a swipe, it will call the closure that’s stored in the swipe handler. This is how it communicates back to the <code>GameViewController</code> that a swap needs to take place.</p>
<p>Still in <em>GameScene.swift</em>, add the following code to the bottom of <code>trySwapHorizontal(vertical:)</code>, replacing the <code>println()</code> statement:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527044"><td class="code" id="p75270code44"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> handler <span style="color: #002200;">=</span> swipeHandler <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> <span style="color: #a61390;">swap</span> <span style="color: #002200;">=</span> Swap<span style="color: #002200;">(</span>cookieA<span style="color: #002200;">:</span> fromCookie, cookieB<span style="color: #002200;">:</span> toCookie<span style="color: #002200;">)</span>
  handler<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This creates a new <code>Swap</code> object, fills in the two cookies to be swapped and then calls the swipe handler to take care of the rest. Because <code>swipeHandler</code> can be nil, you use optional binding to get a valid reference first.</p>
<p><code>GameViewController</code> will decide whether the swap is valid; if it is, you’ll need to animate the two cookies. Add the following method to do this in <em>GameScene.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527045"><td class="code" id="p75270code45"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> animateSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">:</span> Swap, completion<span style="color: #002200;">:</span> <span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #002200;">(</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> spriteA <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieA.sprite<span style="color: #002200;">!</span>
  <span style="color: #a61390;">let</span> spriteB <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieB.sprite<span style="color: #002200;">!</span>
&nbsp;
  spriteA.zPosition <span style="color: #002200;">=</span> <span style="color: #2400d9;">100</span>
  spriteB.zPosition <span style="color: #002200;">=</span> <span style="color: #2400d9;">90</span>
&nbsp;
  <span style="color: #a61390;">let</span> Duration<span style="color: #002200;">:</span> <span style="color: #400080;">NSTimeInterval</span> <span style="color: #002200;">=</span> <span style="color: #2400d9;">0.3</span>
&nbsp;
  <span style="color: #a61390;">let</span> moveA <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.moveTo<span style="color: #002200;">(</span>spriteB.position, duration<span style="color: #002200;">:</span> Duration<span style="color: #002200;">)</span>
  moveA.timingMode <span style="color: #002200;">=</span> .EaseOut
  spriteA.runAction<span style="color: #002200;">(</span>moveA, completion<span style="color: #002200;">:</span> completion<span style="color: #002200;">)</span>
&nbsp;
  <span style="color: #a61390;">let</span> moveB <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.moveTo<span style="color: #002200;">(</span>spriteA.position, duration<span style="color: #002200;">:</span> Duration<span style="color: #002200;">)</span>
  moveB.timingMode <span style="color: #002200;">=</span> .EaseOut
  spriteB.runAction<span style="color: #002200;">(</span>moveB<span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This is basic <code>SKAction</code> animation code: You move cookie A to the position of cookie B and vice versa. </p>
<p>The cookie that was the origin of the swipe is in <code>cookieA</code> and the animation looks best if that one appears on top, so this method adjusts the relative <code>zPosition</code> of the two cookie sprites to make that happen. </p>
<p>After the animation completes, the action on <code>cookieA</code> calls a completion block so the caller can continue doing whatever it needs to do. That’s a common pattern for this game: The game waits until an animation is complete and then it resumes. </p>
<p><code>() -&gt; ()</code> is simply shorthand for a closure that returns void and takes no parameters.</p>
<p>Now that you’ve handled the view, there’s still the model to deal with before getting to the controller! Open <em>Level.swift</em> and add the following method:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527046"><td class="code" id="p75270code46"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> performSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">:</span> Swap<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> columnA <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieA.column
  <span style="color: #a61390;">let</span> rowA <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieA.row
  <span style="color: #a61390;">let</span> columnB <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieB.column
  <span style="color: #a61390;">let</span> rowB <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieB.row
&nbsp;
  cookies<span style="color: #002200;">[</span>columnA, rowA<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieB
  <span style="color: #a61390;">swap</span>.cookieB.column <span style="color: #002200;">=</span> columnA
  <span style="color: #a61390;">swap</span>.cookieB.row <span style="color: #002200;">=</span> rowA
&nbsp;
  cookies<span style="color: #002200;">[</span>columnB, rowB<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieA
  <span style="color: #a61390;">swap</span>.cookieA.column <span style="color: #002200;">=</span> columnB
  <span style="color: #a61390;">swap</span>.cookieA.row <span style="color: #002200;">=</span> rowB
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This first makes temporary copies of the row and column numbers from the <code>Cookie</code> objects because they get overwritten. To make the swap, it updates the <code>cookies</code> array, as well as the column and row properties of the <code>Cookie</code> objects, which shouldn’t go out of sync. That’s it for the data model.</p>
<p>Go to <em>GameViewController.swift</em> and add the following method:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527047"><td class="code" id="p75270code47"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> handleSwipe<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">:</span> Swap<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">false</span>
&nbsp;
  level.performSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span>
&nbsp;
  scene.animateSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">self</span>.view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>You first tell the level to perform the swap, which updates the data model—and then tell the scene to animate the swap, which updates the view. Over the course of this tutorial, you’ll add the rest of the gameplay logic to this function.</p>
<p>While the animation is happening, you don’t want the player to be able to touch anything else, so you temporarily turn off <code>userInteractionEnabled</code> on the view. You turn it back on in the completion block that is passed to <code>animateSwap()</code>.</p>
<div class="note">
<p><em>Note:</em> The above uses so-called <i>trailing closure</i> syntax, where the closure is written behind the function call. An alternative way to write it is as follows:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527048"><td class="code" id="p75270code48"><pre class="swift" style="font-family:monospace;">scene.animateSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span>, completion<span style="color: #002200;">:</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">self</span>.view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
<span style="color: #002200;">}</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

</div>
<p>Also add the following line to <code>viewDidLoad()</code>, just before the line that presents the scene:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527049"><td class="code" id="p75270code49"><pre class="swift" style="font-family:monospace;">scene.swipeHandler <span style="color: #002200;">=</span> handleSwipe</pre></td></tr></tbody></table></div>

<p>This assigns the <code>handleSwipe()</code> function to <code>GameScene</code>’s <code>swipeHandler</code> property. Now whenever <code>GameScene</code> calls <code>swipeHandler(swap)</code>, it actually calls a function in <code>GameViewController</code>. Freaky! This works because in Swift you can use functions and closures interchangeably. </p>
<p>Build and run the app. You can now swap the cookies! Also, try to make a swap across a gap—it won’t work!</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Swap-cookies.gif" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Swap-cookies.gif" alt="Swap cookies" width="316" height="284" class="aligncenter size-full wp-image-66902"></a></p>
<h2>Highlighting the Cookies</h2>
<p>In <i>Candy Crush Saga</i>, the candy you swipe lights up for a brief moment. You can achieve this effect in Cookie Crunch Adventure by placing a highlight image on top of the sprite.</p>
<p>The texture atlas has highlighted versions of the cookie sprites that are brighter and more saturated. The <code>CookieType</code> enum already has a function to return the name of this image: <code>highlightedSpriteName</code>.</p>
<p>You will improve <code>GameScene</code> to add this highlighted cookie on top of the existing cookie sprite. Adding it as a new sprite, as opposed to replacing the existing sprite’s texture, makes it easier to crossfade back to the original image.</p>
<p>In <em>GameScene.swift</em>, add a new private property to the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527050"><td class="code" id="p75270code50"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> selectionSprite <span style="color: #002200;">=</span> <span style="color: #400080;">SKSpriteNode</span><span style="color: #002200;">(</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>Add the following method:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527051"><td class="code" id="p75270code51"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> showSelectionIndicatorForCookie<span style="color: #002200;">(</span>cookie<span style="color: #002200;">:</span> Cookie<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">if</span> selectionSprite.parent <span style="color: #002200;">!=</span> <span style="color: #a61390;">nil</span> <span style="color: #002200;">{</span>
    selectionSprite.removeFromParent<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> sprite <span style="color: #002200;">=</span> cookie.sprite <span style="color: #002200;">{</span>
    <span style="color: #a61390;">let</span> texture <span style="color: #002200;">=</span> SKTexture<span style="color: #002200;">(</span>imageNamed<span style="color: #002200;">:</span> cookie.cookieType.highlightedSpriteName<span style="color: #002200;">)</span>
    selectionSprite.size <span style="color: #002200;">=</span> texture.size<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
    selectionSprite.runAction<span style="color: #002200;">(</span><span style="color: #400080;">SKAction</span>.setTexture<span style="color: #002200;">(</span>texture<span style="color: #002200;">)</span><span style="color: #002200;">)</span>
&nbsp;
    sprite.addChild<span style="color: #002200;">(</span>selectionSprite<span style="color: #002200;">)</span>
    selectionSprite.alpha <span style="color: #002200;">=</span> <span style="color: #2400d9;">1.0</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This gets the name of the highlighted sprite image from the <code>Cookie</code> object and puts the corresponding texture on the selection sprite. Simply setting the texture on the sprite doesn’t give it the correct size but using an <code>SKAction</code> does.</p>
<p>You also make the selection sprite visible by setting its alpha to 1. You add the selection sprite as a child of the cookie sprite so that it moves along with the cookie sprite in the swap animation.</p>
<p>Add the opposite method, <code>hideSelectionIndicator()</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527052"><td class="code" id="p75270code52"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> hideSelectionIndicator<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  selectionSprite.runAction<span style="color: #002200;">(</span><span style="color: #400080;">SKAction</span>.sequence<span style="color: #002200;">(</span><span style="color: #002200;">[</span>
    <span style="color: #400080;">SKAction</span>.fadeOutWithDuration<span style="color: #002200;">(</span><span style="color: #2400d9;">0.3</span><span style="color: #002200;">)</span>,
    <span style="color: #400080;">SKAction</span>.removeFromParent<span style="color: #002200;">(</span><span style="color: #002200;">)</span><span style="color: #002200;">]</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This method removes the selection sprite by fading it out.</p>
<p>It remains for you to call these methods. First, in <code>touchesBegan()</code>, in the <code>if let cookie = ...</code> section, add:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527053"><td class="code" id="p75270code53"><pre class="swift" style="font-family:monospace;">showSelectionIndicatorForCookie<span style="color: #002200;">(</span>cookie<span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>And in <code>touchesMoved()</code>, after the call to <code>trySwapHorizontal()</code>, add:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527054"><td class="code" id="p75270code54"><pre class="swift" style="font-family:monospace;">hideSelectionIndicator<span style="color: #002200;">(</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>There is one last place to call <code>hideSelectionIndicator()</code>. If the user just taps on the screen rather than swipes, you want to fade out the highlighted sprite, too. Add these lines to the <i>top</i> of <code>touchesEnded()</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527055"><td class="code" id="p75270code55"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">if</span> selectionSprite.parent <span style="color: #002200;">!=</span> <span style="color: #a61390;">nil</span> <span style="color: #002200;">&amp;&amp;</span> swipeFromColumn <span style="color: #002200;">!=</span> <span style="color: #a61390;">nil</span> <span style="color: #002200;">{</span>
  hideSelectionIndicator<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Build and run, and highlight some cookies!</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Highlighted-cookies.gif" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Highlighted-cookies.gif" alt="Highlighted cookies" width="316" height="284" class="aligncenter size-full wp-image-66888"></a></p>
<h2>A Smarter Way to Fill the Array</h2>
<p>The purpose of this game is to make chains of three or more of the same cookie. But right now, when you run the game there may already be such chains on the screen. That’s no good—you only want there to be matches after the user swaps two cookies or after new cookies fall down the screen. </p>
<p>Here’s your rule: Whenever it’s the user’s turn to make a move, whether at the start of the game or at the end of a turn, no matches may be on the board already. To guarantee this is the case, you have to make the method that fills up the cookies array a bit smarter. </p>
<p>Go to <em>Level.swift</em> and find <code>createInitialCookies()</code>. Replace the single line that calculates the random <code>cookieType</code> with the following:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527056"><td class="code" id="p75270code56"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> cookieType<span style="color: #002200;">:</span> CookieType
<span style="color: #a61390;">do</span> <span style="color: #002200;">{</span>
  cookieType <span style="color: #002200;">=</span> CookieType.random<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span>
<span style="color: #a61390;">while</span> <span style="color: #002200;">(</span>column &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">2</span> <span style="color: #002200;">&amp;&amp;</span>
        cookies<span style="color: #002200;">[</span>column <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span>, row<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType <span style="color: #002200;">&amp;&amp;</span>
        cookies<span style="color: #002200;">[</span>column <span style="color: #002200;">-</span> <span style="color: #2400d9;">2</span>, row<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType<span style="color: #002200;">)</span>
   || <span style="color: #002200;">(</span>row &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">2</span> <span style="color: #002200;">&amp;&amp;</span>
        cookies<span style="color: #002200;">[</span>column, row <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType <span style="color: #002200;">&amp;&amp;</span>
        cookies<span style="color: #002200;">[</span>column, row <span style="color: #002200;">-</span> <span style="color: #2400d9;">2</span><span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType<span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>Yowza! What is all this? This piece of logic picks the cookie type at random and makes sure that it never creates a chain of three or more.</p>
<p>In pseudo-code, it looks like this:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527057"><td class="code" id="p75270code57"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">do</span> <span style="color: #002200;">{</span>
  generate a new random cookie type
<span style="color: #002200;">}</span> 
<span style="color: #a61390;">while</span> there are already two cookies of this type to the left
   or there are already two cookies of this type below</pre></td></tr></tbody></table></div>

<p>If the new random number causes a chain of three—because there are already two cookies of this type to the left or below—then the method tries again. The loop repeats until it finds a random number that does not create a chain of three or more. It only has to look to the left or below because there are no cookies yet on the right or above.</p>
<p>Try it out! Run the app and verify that there are no longer any chains in the initial state of the game.</p>
<p><a href="http://cdn5.raywenderlich.com/wp-content/uploads/2014/02/No-chains-in-initial-state.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/No-chains-in-initial-state-301x500.png" alt="No chains in initial state" width="301" height="500" class="aligncenter size-large wp-image-66897"></a></p>
<h2>Not All Swaps Are Allowed</h2>
<p>You only want the let the player swap two cookies if it would result in either (or both) of these cookies making a chain of three or more.</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Allowed-swap.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Allowed-swap.png" alt="Allowed swap" width="385" height="288" class="aligncenter size-full wp-image-66883"></a></p>
<p>You need to add some logic to the game to detect whether a swap results in a chain. There are two ways you could do this. The most obvious way is to check at the moment the user tries the swap.</p>
<p>Or—and this is what you’ll do in this tutorial—you could build a list of all possible moves after the level is shuffled. Then you only have to check if the attempted swap is in that list.</p>
<div class="note">
<p><em>Note:</em> Building a list also makes it easy to show a hint to the player. You’re not going to do that in this tutorial, but in <i>Candy Crush Saga</i>, if you don’t play for a few seconds, the game lights up a possible swap. You can implement this for yourself by picking a random item from this list of possible moves.</p>
</div>
<p>In <em>Level.swift</em>, add a new property:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527058"><td class="code" id="p75270code58"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> possibleSwaps <span style="color: #002200;">=</span> Set&lt;Swap&gt;<span style="color: #002200;">(</span><span style="color: #002200;">)</span>  <span style="color: #11740a; font-style: italic;">// private</span></pre></td></tr></tbody></table></div>

<p>Again, you’re using a <code>Set</code> here instead of an <code>Array</code> because the order of the elements in this collection isn’t important. This <code>Set</code> will contain <code>Swap</code> objects. If the player tries to swap two cookies that are not in the set, then the game won’t accept the swap as a valid move.</p>
<p>Xcode warns that <code>Swap</code> cannot be used in a <code>Set</code>, and that’s because <code>Swap</code> does not implement the <code>Hashable</code> protocol yet.</p>
<p>Open up <em>Swap.swift</em> and make the following changes. First, add <code>Hashable</code> to the class declaration:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527059"><td class="code" id="p75270code59"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">class</span> Swap<span style="color: #002200;">:</span> <span style="color: #a61390;">Printable</span>, Hashable <span style="color: #002200;">{</span></pre></td></tr></tbody></table></div>

<p>Then add the <code>hashValue</code> property inside the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527060"><td class="code" id="p75270code60"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">var</span> hashValue<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> cookieA.hashValue <span style="color: #002200;">^</span> cookieB.hashValue
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This simply combines the hash values of the two cookies with the exclusive-or operator. That’s a common trick to make hash values.</p>
<p>And finally, add the <code>==</code> function outside of the class:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527061"><td class="code" id="p75270code61"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> <span style="color: #002200;">==</span><span style="color: #002200;">(</span>lhs<span style="color: #002200;">:</span> Swap, rhs<span style="color: #002200;">:</span> Swap<span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> <span style="color: #002200;">(</span>lhs.cookieA <span style="color: #002200;">==</span> rhs.cookieA <span style="color: #002200;">&amp;&amp;</span> lhs.cookieB <span style="color: #002200;">==</span> rhs.cookieB<span style="color: #002200;">)</span> ||
         <span style="color: #002200;">(</span>lhs.cookieB <span style="color: #002200;">==</span> rhs.cookieA <span style="color: #002200;">&amp;&amp;</span> lhs.cookieA <span style="color: #002200;">==</span> rhs.cookieB<span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Now you can use <code>Swap</code> objects in a <code>Set</code> and the compiler error should be history.</p>
<p>At the start of each turn, you need to detect which cookies the player can swap. You’re going to make this happen in <code>shuffle()</code>. Go back to <em>Level.swift</em> and change the code for that method to:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527062"><td class="code" id="p75270code62"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> shuffle<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; Set&lt;Cookie&gt; <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> <span style="color: #a61390;">set</span><span style="color: #002200;">:</span> Set&lt;Cookie&gt;
  <span style="color: #a61390;">do</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">set</span> <span style="color: #002200;">=</span> createInitialCookies<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
    detectPossibleSwaps<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
    <span style="color: #a61390;">println</span><span style="color: #002200;">(</span><span style="color: #bf1d1a;">"possible swaps: <span style="color: #2400d9;">\(</span>possibleSwaps)"</span><span style="color: #002200;">)</span>
  <span style="color: #002200;">}</span>
  <span style="color: #a61390;">while</span> possibleSwaps.<span style="color: #a61390;">count</span> <span style="color: #002200;">==</span> <span style="color: #2400d9;">0</span>
&nbsp;
  <span style="color: #a61390;">return</span> <span style="color: #a61390;">set</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>As before, this calls <code>createInitialCookies()</code> to fill up the level with random cookie objects. But then it calls a new method that you will add shortly, <code>detectPossibleSwaps()</code>, to fill up the new <code>possibleSwaps</code> set.</p>
<p>In the very rare case that you end up with a distribution of cookies that allows for no swaps at all, this loop repeats to try again. You can test this with a very small level, such as one with only 3×3 tiles. I’ve included such a level for you in the project called <em>Level_4.json</em>.</p>
<p><code>detectPossibleSwaps()</code> will use a helper method to see if a cookie is part of a chain. Add this method now:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527063"><td class="code" id="p75270code63"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> hasChainAtColumn<span style="color: #002200;">(</span>column<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span>, row<span style="color: #002200;">:</span> <span style="color: #a61390;">Int</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> cookieType <span style="color: #002200;">=</span> cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span><span style="color: #002200;">!</span>.cookieType
&nbsp;
  <span style="color: #a61390;">var</span> horzLength <span style="color: #002200;">=</span> <span style="color: #2400d9;">1</span>
  <span style="color: #a61390;">for</span> <span style="color: #a61390;">var</span> i <span style="color: #002200;">=</span> column <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span>; i &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> cookies<span style="color: #002200;">[</span>i, row<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType; 
        <span style="color: #002200;">--</span>i, <span style="color: #002200;">++</span>horzLength <span style="color: #002200;">{</span> <span style="color: #002200;">}</span>
  <span style="color: #a61390;">for</span> <span style="color: #a61390;">var</span> i <span style="color: #002200;">=</span> column <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span>; i &lt; NumColumns <span style="color: #002200;">&amp;&amp;</span> cookies<span style="color: #002200;">[</span>i, row<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType;
        <span style="color: #002200;">++</span>i, <span style="color: #002200;">++</span>horzLength <span style="color: #002200;">{</span> <span style="color: #002200;">}</span>
  <span style="color: #a61390;">if</span> horzLength &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">3</span> <span style="color: #002200;">{</span> <span style="color: #a61390;">return</span> <span style="color: #a61390;">true</span> <span style="color: #002200;">}</span>
&nbsp;
  <span style="color: #a61390;">var</span> vertLength <span style="color: #002200;">=</span> <span style="color: #2400d9;">1</span>
  <span style="color: #a61390;">for</span> <span style="color: #a61390;">var</span> i <span style="color: #002200;">=</span> row <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span>; i &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> cookies<span style="color: #002200;">[</span>column, i<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType; 
        <span style="color: #002200;">--</span>i, <span style="color: #002200;">++</span>vertLength <span style="color: #002200;">{</span> <span style="color: #002200;">}</span>
  <span style="color: #a61390;">for</span> <span style="color: #a61390;">var</span> i <span style="color: #002200;">=</span> row <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span>; i &lt; NumRows <span style="color: #002200;">&amp;&amp;</span> cookies<span style="color: #002200;">[</span>column, i<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType;
        <span style="color: #002200;">++</span>i, <span style="color: #002200;">++</span>vertLength <span style="color: #002200;">{</span> <span style="color: #002200;">}</span>
  <span style="color: #a61390;">return</span> vertLength &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">3</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>A chain is three or more consecutive cookies of the same type in a row or column. This method may look a little strange but that’s because it stuffs a lot of the logic inside the for-statements.</p>
<p><a href="http://cdn1.raywenderlich.com/wp-content/uploads/2014/02/Look-left-right-up-down.png" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Look-left-right-up-down-616x500.png" alt="Look left right up down" width="616" height="500" class="aligncenter size-large wp-image-66895"></a></p>
<p>Given a cookie in a particular square on the grid, this method first looks to the left. As long as it finds a cookie of the same type, it increments <code>horzLength</code> and keeps going left. This is expressed succinctly in a single line of code:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527064"><td class="code" id="p75270code64"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">for</span> <span style="color: #a61390;">var</span> i <span style="color: #002200;">=</span> column <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span>; i &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span> cookies<span style="color: #002200;">[</span>i, row<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType; <span style="color: #002200;">--</span>i, <span style="color: #002200;">++</span>horzLength <span style="color: #002200;">{</span> <span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This <code>for</code> loop has an empty body. That means all the logic happens inside its parameters.</p>

<div class="wp_codebox"><table><tbody><tr id="p7527065"><td class="code" id="p75270code65"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">for</span> <span style="color: #a61390;">var</span> i <span style="color: #002200;">=</span> column <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span>;  <span style="color: #11740a; font-style: italic;">// start on the left of the current cookie</span>
&nbsp;
  i &gt;<span style="color: #002200;">=</span> <span style="color: #2400d9;">0</span> <span style="color: #002200;">&amp;&amp;</span>                                   <span style="color: #11740a; font-style: italic;">// keep going while not left-most column reached</span>
  cookies<span style="color: #002200;">[</span>i, row<span style="color: #002200;">]</span>?.cookieType <span style="color: #002200;">==</span> cookieType;  <span style="color: #11740a; font-style: italic;">// and still the same cookie type</span>
&nbsp;
  <span style="color: #002200;">--</span>i,                   <span style="color: #11740a; font-style: italic;">// go to the next column on the left</span>
  <span style="color: #002200;">++</span>horzLength           <span style="color: #11740a; font-style: italic;">// and increment the length</span>
  <span style="color: #002200;">{</span> <span style="color: #002200;">}</span>                    <span style="color: #11740a; font-style: italic;">// do nothing inside the loop</span></pre></td></tr></tbody></table></div>

<p>You can also write this out using a while statement but the <code>for</code> loop allows you to fit everything on a single line. :] There are also loops for looking to the right, above and below.</p>
<div class="note">
<p><em>Note:</em> It’s possible that <code>cookies[column, row]</code> will return <code>nil</code> because of a gap in the level design, meaning there is no cookie at that location. That’s no problem because of Swift’s <i>optional chaining</i>. Because of the <code>?</code> operator, the loop will terminate whenever such a gap is encountered.</p>
</div>
<p>Now that you have this method, you can implement <code>detectPossibleSwaps()</code>. Here’s how it will work at a high level: </p>
<ol>
<li>It will step through the rows and columns of the 2-D grid and simply swap each cookie with the one next to it, one at a time.</li>
<li>If swapping these two cookies creates a chain, it will add a new <code>Swap</code> object to the list of <code>possibleSwaps</code>.</li>
<li>Then, it will swap these cookies back to restore the original state and continue with the next cookie until it has swapped them all.</li>
<li>It will go through the above steps twice: once to check all horizontal swaps and once to check all vertical swaps.</li>
</ol>
<p>It’s a big one, so you’ll take it in parts!</p>
<p>First, add the outline of the method:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527066"><td class="code" id="p75270code66"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> detectPossibleSwaps<span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">var</span> <span style="color: #a61390;">set</span> <span style="color: #002200;">=</span> Set&lt;Swap&gt;<span style="color: #002200;">(</span><span style="color: #002200;">)</span>
&nbsp;
  <span style="color: #a61390;">for</span> row <span style="color: #a61390;">in</span> <span style="color: #2400d9;">0</span>..&lt;NumRows <span style="color: #002200;">{</span>
    <span style="color: #a61390;">for</span> column <span style="color: #a61390;">in</span> <span style="color: #2400d9;">0</span>..&lt;NumColumns <span style="color: #002200;">{</span>
      <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> cookie <span style="color: #002200;">=</span> cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">{</span>
&nbsp;
        <span style="color: #11740a; font-style: italic;">// TODO: detection logic goes here</span>
      <span style="color: #002200;">}</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span>
&nbsp;
  possibleSwaps <span style="color: #002200;">=</span> <span style="color: #a61390;">set</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This is pretty simple: The method loops through the rows and columns, and for each spot, if there is a cookie rather than an empty square, it performs the detection logic. Finally, the method places the results into the <code>possibleSwaps</code> property.</p>
<p>The detection will consist of two separate parts that do the same thing but in different directions. First you want to swap the cookie with the one on the right, and then you want to swap the cookie with the one above it. Remember, row 0 is at the bottom so you’ll work your way up.</p>
<p>Add the following code where it says “TODO: detection logic goes here”:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527067"><td class="code" id="p75270code67"><pre class="swift" style="font-family:monospace;"><span style="color: #11740a; font-style: italic;">// Is it possible to swap this cookie with the one on the right?</span>
<span style="color: #a61390;">if</span> column &lt; NumColumns <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span> <span style="color: #002200;">{</span>
  <span style="color: #11740a; font-style: italic;">// Have a cookie in this spot? If there is no tile, there is no cookie.</span>
  <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> other <span style="color: #002200;">=</span> cookies<span style="color: #002200;">[</span>column <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span>, row<span style="color: #002200;">]</span> <span style="color: #002200;">{</span>
    <span style="color: #11740a; font-style: italic;">// Swap them</span>
    cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> other
    cookies<span style="color: #002200;">[</span>column <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span>, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> cookie
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Is either cookie now part of a chain?</span>
    <span style="color: #a61390;">if</span> hasChainAtColumn<span style="color: #002200;">(</span>column <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span>, row<span style="color: #002200;">:</span> row<span style="color: #002200;">)</span> ||
       hasChainAtColumn<span style="color: #002200;">(</span>column, row<span style="color: #002200;">:</span> row<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
      <span style="color: #a61390;">set</span>.addElement<span style="color: #002200;">(</span>Swap<span style="color: #002200;">(</span>cookieA<span style="color: #002200;">:</span> cookie, cookieB<span style="color: #002200;">:</span> other<span style="color: #002200;">)</span><span style="color: #002200;">)</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Swap them back</span>
    cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> cookie
    cookies<span style="color: #002200;">[</span>column <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span>, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> other
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This attempts to swap the current cookie with the cookie on the right, if there is one. If this creates a chain of three or more, the code adds a new <code>Swap</code> object to the set.</p>
<p>Now add the following code directly below the code above:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527068"><td class="code" id="p75270code68"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">if</span> row &lt; NumRows <span style="color: #002200;">-</span> <span style="color: #2400d9;">1</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">if</span> <span style="color: #a61390;">let</span> other <span style="color: #002200;">=</span> cookies<span style="color: #002200;">[</span>column, row <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">]</span> <span style="color: #002200;">{</span>
    cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> other
    cookies<span style="color: #002200;">[</span>column, row <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">]</span> <span style="color: #002200;">=</span> cookie
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Is either cookie now part of a chain?</span>
    <span style="color: #a61390;">if</span> hasChainAtColumn<span style="color: #002200;">(</span>column, row<span style="color: #002200;">:</span> row <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">)</span> ||
       hasChainAtColumn<span style="color: #002200;">(</span>column, row<span style="color: #002200;">:</span> row<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
      <span style="color: #a61390;">set</span>.addElement<span style="color: #002200;">(</span>Swap<span style="color: #002200;">(</span>cookieA<span style="color: #002200;">:</span> cookie, cookieB<span style="color: #002200;">:</span> other<span style="color: #002200;">)</span><span style="color: #002200;">)</span>
    <span style="color: #002200;">}</span>
&nbsp;
    <span style="color: #11740a; font-style: italic;">// Swap them back</span>
    cookies<span style="color: #002200;">[</span>column, row<span style="color: #002200;">]</span> <span style="color: #002200;">=</span> cookie
    cookies<span style="color: #002200;">[</span>column, row <span style="color: #002200;">+</span> <span style="color: #2400d9;">1</span><span style="color: #002200;">]</span> <span style="color: #002200;">=</span> other
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This does exactly the same thing, but for the cookie above instead of on the right.</p>
<p>That should do it. In summary, this algorithm performs a swap for each pair of cookies, checks whether it results in a chain and then undoes the swap, recording every chain it finds.</p>
<p>Now run the app and you should see something like this in the Xcode debug pane:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527069"><td class="code" id="p75270code69"><pre class="bash" style="font-family:monospace;">possible swaps: <span style="color: #7a0874; font-weight: bold;">[</span>
swap <span style="color: #7a0874; font-weight: bold;">type</span>:SugarCookie square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">6</span>,<span style="color: #000000;">5</span><span style="color: #7a0874; font-weight: bold;">)</span> with <span style="color: #7a0874; font-weight: bold;">type</span>:Cupcake square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">7</span>,<span style="color: #000000;">5</span><span style="color: #7a0874; font-weight: bold;">)</span>: <span style="color: #c20cb9; font-weight: bold;">true</span>, 
swap <span style="color: #7a0874; font-weight: bold;">type</span>:Croissant square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">3</span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">)</span> with <span style="color: #7a0874; font-weight: bold;">type</span>:Macaroon square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">4</span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">)</span>: <span style="color: #c20cb9; font-weight: bold;">true</span>, 
swap <span style="color: #7a0874; font-weight: bold;">type</span>:Danish square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">6</span>,<span style="color: #000000;">0</span><span style="color: #7a0874; font-weight: bold;">)</span> with <span style="color: #7a0874; font-weight: bold;">type</span>:Macaroon square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">6</span>,<span style="color: #000000;">1</span><span style="color: #7a0874; font-weight: bold;">)</span>: <span style="color: #c20cb9; font-weight: bold;">true</span>, 
swap <span style="color: #7a0874; font-weight: bold;">type</span>:Cupcake square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">6</span>,<span style="color: #000000;">4</span><span style="color: #7a0874; font-weight: bold;">)</span> with <span style="color: #7a0874; font-weight: bold;">type</span>:SugarCookie square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">6</span>,<span style="color: #000000;">5</span><span style="color: #7a0874; font-weight: bold;">)</span>: <span style="color: #c20cb9; font-weight: bold;">true</span>, 
swap <span style="color: #7a0874; font-weight: bold;">type</span>:Croissant square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">4</span>,<span style="color: #000000;">2</span><span style="color: #7a0874; font-weight: bold;">)</span> with <span style="color: #7a0874; font-weight: bold;">type</span>:Macaroon square:<span style="color: #7a0874; font-weight: bold;">(</span><span style="color: #000000;">4</span>,<span style="color: #000000;">3</span><span style="color: #7a0874; font-weight: bold;">)</span>: <span style="color: #c20cb9; font-weight: bold;">true</span>, 
. . .</pre></td></tr></tbody></table></div>

<h2>To Swap or Not to Swap…</h2>
<p>Let’s put this list of possible moves to good use. Add the following method to <em>Level.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527070"><td class="code" id="p75270code70"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> isPossibleSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">:</span> Swap<span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #a61390;">Bool</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">return</span> possibleSwaps.containsElement<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This looks to see if the set of possible swaps contains the specified <code>Swap</code> object. But wait a minute… when you perform a swipe, <code>GameScene</code> creates a <i>new</i> <code>Swap</code> object. How could <code>isPossibleSwap()</code> possibly find that object inside its list? It may have a <code>Swap</code> object that describes exactly the same move, but the actual instances in memory are different.</p>
<p>When you run <code>set.containsElement(object)</code>, the set calls <code>==</code> on that object and all the objects it contains to determine if they match. Because you already provided an <code>==</code> operator for <code>Swap</code>, this automagically works! It doesn’t matter that the <code>Swap</code> objects are actually different instances; the set will find a match as long as two <code>Swap</code>s can be considered equal.</p>
<p>Finally call the method in <em>GameViewController.swift</em>, inside the <code>handleSwipe()</code> function:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527071"><td class="code" id="p75270code71"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> handleSwipe<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">:</span> Swap<span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">false</span>
&nbsp;
  <span style="color: #a61390;">if</span> level.isPossibleSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    level.performSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span>
    scene.animateSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
      <span style="color: #a61390;">self</span>.view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
    <span style="color: #002200;">}</span>
  <span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">{</span>
     view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Now the game will only perform the swap if it’s in the list of sanctioned swaps.</p>
<p>Build and run to try it out. You should only be able to make swaps if they result in a chain.</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Ignore-invalid-swap.gif" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Ignore-invalid-swap.gif" alt="Ignore invalid swap" width="316" height="284" class="aligncenter size-full wp-image-66889"></a></p>
<p>Note that after you perform a swap, the “valid swaps” list is now invalid. You’ll fix that in the next part of the series.</p>
<p>It’s also fun to animate attempted swaps that are invalid, so add the following method to <em>GameScene.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527072"><td class="code" id="p75270code72"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">func</span> animateInvalidSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">:</span> Swap, completion<span style="color: #002200;">:</span> <span style="color: #002200;">(</span><span style="color: #002200;">)</span> <span style="color: #002200;">-</span>&gt; <span style="color: #002200;">(</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
  <span style="color: #a61390;">let</span> spriteA <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieA.sprite<span style="color: #002200;">!</span>
  <span style="color: #a61390;">let</span> spriteB <span style="color: #002200;">=</span> <span style="color: #a61390;">swap</span>.cookieB.sprite<span style="color: #002200;">!</span>
&nbsp;
  spriteA.zPosition <span style="color: #002200;">=</span> <span style="color: #2400d9;">100</span>
  spriteB.zPosition <span style="color: #002200;">=</span> <span style="color: #2400d9;">90</span>
&nbsp;
  <span style="color: #a61390;">let</span> Duration<span style="color: #002200;">:</span> <span style="color: #400080;">NSTimeInterval</span> <span style="color: #002200;">=</span> <span style="color: #2400d9;">0.2</span>
&nbsp;
  <span style="color: #a61390;">let</span> moveA <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.moveTo<span style="color: #002200;">(</span>spriteB.position, duration<span style="color: #002200;">:</span> Duration<span style="color: #002200;">)</span>
  moveA.timingMode <span style="color: #002200;">=</span> .EaseOut
&nbsp;
  <span style="color: #a61390;">let</span> moveB <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.moveTo<span style="color: #002200;">(</span>spriteA.position, duration<span style="color: #002200;">:</span> Duration<span style="color: #002200;">)</span>
  moveB.timingMode <span style="color: #002200;">=</span> .EaseOut
&nbsp;
  spriteA.runAction<span style="color: #002200;">(</span><span style="color: #400080;">SKAction</span>.sequence<span style="color: #002200;">(</span><span style="color: #002200;">[</span>moveA, moveB<span style="color: #002200;">]</span><span style="color: #002200;">)</span>, completion<span style="color: #002200;">:</span> completion<span style="color: #002200;">)</span>
  spriteB.runAction<span style="color: #002200;">(</span><span style="color: #400080;">SKAction</span>.sequence<span style="color: #002200;">(</span><span style="color: #002200;">[</span>moveB, moveA<span style="color: #002200;">]</span><span style="color: #002200;">)</span><span style="color: #002200;">)</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>This method is similar to <code>animateSwap(swap:, completion:)</code>, but here it slides the cookies to their new positions and then immediately flips them back. </p>
<p>In <em>GameViewController.swift</em>, change the else-clause inside <code>handleSwipe()</code> to:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527073"><td class="code" id="p75270code73"><pre class="swift" style="font-family:monospace;"><span style="color: #002200;">}</span> <span style="color: #a61390;">else</span> <span style="color: #002200;">{</span>
  scene.animateInvalidSwap<span style="color: #002200;">(</span><span style="color: #a61390;">swap</span><span style="color: #002200;">)</span> <span style="color: #002200;">{</span>
    <span style="color: #a61390;">self</span>.view.userInteractionEnabled <span style="color: #002200;">=</span> <span style="color: #a61390;">true</span>
  <span style="color: #002200;">}</span>
<span style="color: #002200;">}</span></pre></td></tr></tbody></table></div>

<p>Now run the app and try to make a swap that won’t result in a chain:</p>
<p><a href="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Invalid-swap.gif" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Invalid-swap.gif" alt="Invalid swap" width="316" height="284" class="aligncenter size-full wp-image-66891"></a></p>
<h2>Make Some Noise</h2>
<p>Before wrapping up the first part of this tutorial, why don’t you go ahead and add some sound effects to the game? Open the Resources folder for this tutorial and drag the <em>Sounds</em> folder into Xcode.</p>
<p>Add new properties for these sound effects to <em>GameScene.swift</em>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527074"><td class="code" id="p75270code74"><pre class="swift" style="font-family:monospace;"><span style="color: #a61390;">let</span> swapSound <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.playSoundFileNamed<span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Chomp.wav"</span>, waitForCompletion<span style="color: #002200;">:</span> <span style="color: #a61390;">false</span><span style="color: #002200;">)</span>
<span style="color: #a61390;">let</span> invalidSwapSound <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.playSoundFileNamed<span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Error.wav"</span>, waitForCompletion<span style="color: #002200;">:</span> <span style="color: #a61390;">false</span><span style="color: #002200;">)</span>
<span style="color: #a61390;">let</span> matchSound <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.playSoundFileNamed<span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Ka-Ching.wav"</span>, waitForCompletion<span style="color: #002200;">:</span> <span style="color: #a61390;">false</span><span style="color: #002200;">)</span>
<span style="color: #a61390;">let</span> fallingCookieSound <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.playSoundFileNamed<span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Scrape.wav"</span>, waitForCompletion<span style="color: #002200;">:</span> <span style="color: #a61390;">false</span><span style="color: #002200;">)</span>
<span style="color: #a61390;">let</span> addCookieSound <span style="color: #002200;">=</span> <span style="color: #400080;">SKAction</span>.playSoundFileNamed<span style="color: #002200;">(</span><span style="color: #bf1d1a;">"Drip.wav"</span>, waitForCompletion<span style="color: #002200;">:</span> <span style="color: #a61390;">false</span><span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>Rather than recreate an <code>SKAction</code> every time you need to play a sound, you’ll load all the sounds just once and keep re-using them. </p>
<p>Then add the following line to the bottom of <code>animateSwap()</code></p>

<div class="wp_codebox"><table><tbody><tr id="p7527075"><td class="code" id="p75270code75"><pre class="swift" style="font-family:monospace;">runAction<span style="color: #002200;">(</span>swapSound<span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>And add this line to the bottom of <code>animateInvalidSwap()</code>:</p>

<div class="wp_codebox"><table><tbody><tr id="p7527076"><td class="code" id="p75270code76"><pre class="swift" style="font-family:monospace;">runAction<span style="color: #002200;">(</span>invalidSwapSound<span style="color: #002200;">)</span></pre></td></tr></tbody></table></div>

<p>That’s all you need to do to make some noise. Chomp! :]</p>
<h2>Where to Go From Here?</h2>
<p>Here is a <a href="http://cdn3.raywenderlich.com/wp-content/uploads/2014/06/CookieCrunch-Swift-Part1.zip" sl-processed="1">sample project</a> with all of the code from the Swift tutorial up to this point.</p>
<p>Your game is shaping up nicely, but there’s still a way to go before it’s finished. For now, though, give yourself a cookie for making it halfway!</p>
<p>In the <a href="http://www.raywenderlich.com/75273/make-game-like-candy-crush-with-swift-tutorial-part-2" sl-processed="1">next part</a>, you’ll implement the remaining pieces of the game flow: removing matching chains and replacing them with new cookies. You’ll also add scoring, lots of new animations and some final polish.</p>
<p>While you eat your cookie, take a moment to let us hear from you in the forums!</p>
<p>Credits: Free game art from <a href="http://www.gameartguppy.com/" sl-processed="1">Game Art Guppy</a>. The music is by <a href="http://incompetech.com/" sl-processed="1">Kevin MacLeod</a>. The sound effects are based on samples from <a href="http://freesound.org/" sl-processed="1">freesound.org</a>.</p>
<p>Portions of the source code were inspired by <a href="https://github.com/gabrielnika/swift-match3" sl-processed="1">Gabriel Nica</a>‘s Swift port of the game.</p>
	
					</div>
					<footer>
						<div class="social-links">
			    			<ul>
										    							<li class="twitter"><div id="tweetbutton75270m" class="tw_button" style="margin-bottom:10px;"><iframe id="twitter-widget-1" scrolling="no" frameborder="0" allowtransparency="true" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/tweet_button.1404859412(1).html" class="twitter-share-button twitter-tweet-button twitter-share-button twitter-count-horizontal" title="Twitter Tweet Button" data-twttr-rendered="true" style="width: 107px; height: 20px;"></iframe></div></li>
		    															<li class="facebook"><div class="fb-like fb_iframe_widget" data-href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;href=http%3A%2F%2Fwww.raywenderlich.com%2F75270%2Fmake-game-like-candy-crush-with-swift-tutorial-part-1&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=450"><span style="vertical-align: bottom; width: 79px; height: 20px;"><iframe name="f151cfa488" width="450px" height="1000px" frameborder="0" allowtransparency="true" scrolling="no" title="fb:like Facebook Social Plugin" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/like(2).html" style="border: none; visibility: visible; width: 79px; height: 20px;" class=""></iframe></span></div></li>
								<li class="facebook iframe-link"><iframe src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/like.html" allowtransparency="true" frameborder="0" scrolling="no" style="width: 50px; height: 20px;"></iframe></li>
			    			</ul>
			    		</div>
					</footer>
				</article>
				<div id="author-information" class="clearfix">
					<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/arrow@2x.png" width="40" height="21" id="arrow">
								
							<div class="author-photo">
								<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file.php" width="100" height="100" class="user-avatar">							</div>
							<div class="author-meta">
									<a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1">Matthijs Hollemans</a>									<p class="bio">Matthijs Hollemans is an independent iOS developer and designer who lives to create awesome software. His focus is on iPad apps because he thinks tablets are way cooler than phones. Whenever he is not glued to his screen, Matthijs plays the piano, is into healthy and natural living, and goes out barefoot running. Visit his website at <a href="http://www.hollance.com/" sl-processed="1">http://www.hollance.com</a>.</p>	
							</div>
											
								<ul class="follow-links">
									<li class="twitter"><a href="http://www.twitter.com/mhollemans" target="_block" sl-processed="1">Follow Matthijs Hollemans on Twitter</a></li>
								</ul>
								   				</div>
   				<section id="comments">
   					<div id="comment-login-module"><form method="post" action="http://www.raywenderlich.com/wp-content/themes/raywenderlich/bridgeapi/phpbb3/login-user.php"><input type="hidden" name="returnurl" value="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1"><div class="comment-area"><h2>Add a Comment</h2><p class="login-text">You need to login to make a comment. If you do not have an account, you can <a href="http://www.raywenderlich.com/login?section=new-account&returnurl=http://www.raywenderlich.com/wp-content/themes/raywenderlich/templates/comment_login_area.php?topicId=16725&forumId=20&pageNumber=1&returnURL=http%3A%2F%2Fwww.raywenderlich.com%2F75270%2Fmake-game-like-candy-crush-with-swift-tutorial-part-1&_=1405448922654" sl-processed="1">create one over here</a></p>Username: <input type="text" name="username" id="username" size="40"> &nbsp;&nbsp;&nbsp; Password: <input type="password" name="password" id="password" size="40"> &nbsp;&nbsp;&nbsp; <input type="submit" value="Log In" name="login" class="RWButton"> <input type="hidden" name="redirect" value="http://www.raywenderlich.com/wp-content/themes/raywenderlich/templates/comment_login_area.php?topicId=16725&amp;forumId=20&amp;pageNumber=1&amp;returnURL=http%3A%2F%2Fwww.raywenderlich.com%2F75270%2Fmake-game-like-candy-crush-with-swift-tutorial-part-1&amp;_=1405448922654#comments"><input type="hidden" name="phpbb_login_box" value="false"><p class="login-text">You can view the discussion in the forum <a href="http://www.raywenderlich.com/forums/viewtopic.php?f=20&t=16725" sl-processed="1">over here</a></p></div></form></div>
<script>
	jQuery(".comment-area").css("display", "none");
	jQuery.ajax({
		type : "GET",
		data : { "topicId" : 16725, "forumId" : 20, "pageNumber" : 1, "returnURL" : "http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1" },
		url : "http://www.raywenderlich.com/wp-content/themes/raywenderlich/templates/comment_login_area.php",
		cache : false,
	}).done(function(html) {
		jQuery("#comment-login-module").html(html);	
	});
</script>

	<hgroup>
		<h2 id="user-comments">User Comments</h2>
		<h2 id="comment-count">59 Comments</h2>	
		<div class="comment-pages top-pages"> 
			[ <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1?pn=1#comments" sl-processed="1">1</a> , <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1?pn=2#comments" sl-processed="1">2</a> , <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1?pn=3#comments" sl-processed="1">3</a> , <span>4</span> ]			</div>
	</hgroup>
	<ul id="user-comment-list">
		<li><div class="comment">This unction (and others) in Set.swift gets an error:<br>
<br>
func allElements() -&gt; [T] {<br>
        return Array(dictionary.keys)<br>
}<br>
<br>
The error is "Consecutive declarations on a line must be separated with an ;".<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/zeeple" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/983808d594450c1df49734d32b803c1b" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/zeeple" sl-processed="1">zeeple</a> <span class="post-date">on July 8, 2014, 10:43 PM</span></span></li><li><div class="comment"><blockquote><div><cite>kenbod wrote:</cite>I'm getting the strangest error when using Xcode 6 Beta 3 with this tutorial. In the file, Array2D.swift with the lines:<br>
<br>
    set {<br>
      array[row*columns + column] = newValue<br>
    }<br>
<br>
I'm getting the error: '@lvalue $T15' is not identical to 'T?' on the line that starts with "array[row@columns + ..."<br>
<br>
The compiler seems to be telling me that the left-hand side of the assignment operation does not have the type T? and therefore it cannot assign newValue to it.<br>
<br>
Any ideas/suggestions?<br>
<br>
I tried cleaning the project and then building it but this error always appears!</div></blockquote><br>
<br>
I did have the same error and the only way to get rid of this was pasting the whole code of that array swift file from the tutorial.<br>
Even though it was 100 % identical to the code I had.<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/nontomatic" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/7f67d02f04b3d1c71758a6aec230e768" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/nontomatic" sl-processed="1">nontomatic</a> <span class="post-date">on July 9, 2014, 12:14 AM</span></span></li><li><div class="comment">The reason for the '@lvalue $T15' is not identical to 'T?' error is that "array" was originally declared with "let". Beta 3 changes the way arrays work, so now it has to be a "var".<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file.php" width="100" height="100" class="user-avatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1">Hollance</a> <span class="post-date">on July 9, 2014, 7:27 AM</span></span></li><li><div class="comment">From Hollance: <br>
<br>
=========<br>
The reason for the '@lvalue $T15' is not identical to 'T?' error is that "array" was originally declared with "let". Beta 3 changes the way arrays work, so now it has to be a "var".<br>
=========<br>
<br>
Thank you! That did the trick! Back to the tutorial!<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/kenbod" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/45606f41eed4d1a22eea94d6574b536c" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/kenbod" sl-processed="1">kenbod</a> <span class="post-date">on July 9, 2014, 1:19 PM</span></span></li><li><div class="comment">The function in Set.swift that is getting the error "Consecutive declarations on a line must be separated with an ;":<br>
<br>
func allElements() -&gt; [T] {<br>
        return Array(dictionary.keys)<br>
}<br>
<br>
Just looking at it it made sense to me that the T should be before the brackets, not inside them, so I changed it to:<br>
<br>
func allElements() -&gt; T[] {<br>
        return Array(dictionary.keys)<br>
}<br>
<br>
And it builds successfully now.  However, I still do not know if this was the problem or if I was completely wrong to move the T.  I am hoping someone more wise in the ways of swift will chime in <!-- s:) --><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/icon_e_smile.gif" alt=":)" title="Smile"><!-- s:) --><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/zeeple" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/983808d594450c1df49734d32b803c1b" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/zeeple" sl-processed="1">zeeple</a> <span class="post-date">on July 9, 2014, 5:03 PM</span></span></li><li><div class="comment"><blockquote><div><cite>zeeple wrote:</cite>Just looking at it it made sense to me that the T should be before the brackets, not inside them</div></blockquote><br>
You need to update your Xcode to beta 3. <!-- s;-) --><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/icon_e_wink.gif" alt=";-)" title="Wink"><!-- s;-) --> This was changed from T[] to [T] in beta 3.<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file.php" width="100" height="100" class="user-avatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1">Hollance</a> <span class="post-date">on July 9, 2014, 5:40 PM</span></span></li><li><div class="comment">Hi,<br>
<br>
Thanks for this great tutorial. I try to do it step by step to understand but got a problem.<br>
<br>
Juste before the "The Scene and the View Controller" chapter, when I did CMD+B to build the projet, I've got two errors in Level.swift (the Setdisappear) but got :<br>
return cookies[column, row] and cookies[column, row] = cookie with error Use of unresolved identifier 'cookies'<br>
<br>
Trying to compare with your code but impossible to find what i forgot.<br>
<br>
Thanks for your help<br>
<br>
Edit : My fault, Level func were place outside the class ... Now I need to find another bug, my cookies are very very pale, as tile were in the first plan and cookies on the second.<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/lbstephane" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/8841b98af798b02b1757c7b99204705e" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/lbstephane" sl-processed="1">lbstephane</a> <span class="post-date">on July 12, 2014, 4:31 PM</span></span></li><li><div class="comment">Is it just me, or does anyone else miss the autocomplete for "return" and "for in"? What is that all caps "RETURN" anyway? <br>
<br>
Very impressive tutorial. I worked through the original and I am quite amazed that you were able to translate it to Swift so quickly. I have only been writing code for about 2 years and Objective-C for about a year and a half. Now at least I can say I have been using Swift since the beginning. Does that make me a veteran Swift developer? :]<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/DarrellNicholas" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(1).php" width="100" height="100" class="user-avatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/DarrellNicholas" sl-processed="1">DarrellNicholas</a> <span class="post-date">on July 12, 2014, 5:14 PM</span></span></li><li><div class="comment">I'm finishing up the Level class and I get a "Use of Unresolved Identifer" when I return createInitialCookies in the shuffle function.  Any ideas why that would happen?<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/RyanJames" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/9f07fa7b556d90acd40e6840a3cf6c16" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/RyanJames" sl-processed="1">RyanJames</a> <span class="post-date">on July 13, 2014, 1:56 AM</span></span></li><li><div class="comment">Check Level func are inside the class not outside, I had the same issue and solved it by placing func inside the class !<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/lbstephane" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/8841b98af798b02b1757c7b99204705e" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/lbstephane" sl-processed="1">lbstephane</a> <span class="post-date">on July 13, 2014, 8:16 AM</span></span></li><li><div class="comment">Hi Matthijs,<br>
<br>
I don't think you need to initialize optionals to nil. That's one of the main points of being an optional after all ...<br>
If you write this:<br>
<dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code><br>
var swipeFromColumn: Int?<br>
var swipeFromRow: Int?<br>
</code></dd></dl><br>
<br>
Then you don't need to do this in any initializer:<br>
<dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>swipeFromColumn = nil<br>
swipeFromRow = nil</code></dd></dl><br>
<br>
Also, I think things like <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if foo == nil {</code></dd></dl> should be replaced by <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if !foo {</code></dd></dl><br>
and things like <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if foo != nil</code></dd></dl> by <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if foo</code></dd></dl><br>
Maybe that was OK in Obj-C, but now that causes issues.<br>
Example: in Level.swift, in func createInitialCookies, if you leave <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if tiles[column, row] != nil {</code></dd></dl><br>
that causes a compiler error. I guess this should be preferred:  <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if tiles[column, row] {</code></dd></dl><br>
<br>
Something to add to the Ray Wenderlich style guide for Swift maybe ?<br>
<br>
Thanks<br>
Fred<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/FreddyF" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/402c07f9a774a46f761f8a28df6a4bf4" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/FreddyF" sl-processed="1">FreddyF</a> <span class="post-date">on July 13, 2014, 4:34 PM</span></span></li><li><div class="comment"><blockquote><div><cite>FreddyF wrote:</cite><br>
Also, I think things like <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if foo == nil {</code></dd></dl> should be replaced by <dl class="codebox"><dt>Code: <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" onclick="selectCode(this); return false;" sl-processed="1">Select all</a></dt><dd><code>if !foo {</code></dd></dl><br>
Maybe that was OK in Obj-C, but now that causes issues.<br>
</div></blockquote><br>
From what I understood that is a bug in the beta 3 compiler.<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file.php" width="100" height="100" class="user-avatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1">Hollance</a> <span class="post-date">on July 14, 2014, 7:49 AM</span></span></li><li><div class="comment">By the way, I have another question (not style-related for once :])<br>
When using a closure containing "self", do I always have to add [unowned self] to avoid a retain cycle ?<br>
What is the rule to apply in that case ?<br>
<br>
Thanks<br>
Fred<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/FreddyF" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/402c07f9a774a46f761f8a28df6a4bf4" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/FreddyF" sl-processed="1">FreddyF</a> <span class="post-date">on July 14, 2014, 8:00 AM</span></span></li><li><div class="comment"><blockquote><div><cite>FreddyF wrote:</cite>By the way, I have another question (not style-related for once :])<br>
When using a closure containing "self", do I always have to add [unowned self] to avoid a retain cycle ?<br>
What is the rule to apply in that case ?<br>
</div></blockquote><br>
It depends. Not all retain cycles are bad, especially if they are just temporary.<br>
<br>
I haven't had much luck using [unowned self] in Swift. Every time I've done so, the app has crashed...<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/comment-quote@2x.png" width="22" height="12" class="quote-arrow"></div><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file.php" width="100" height="100" class="user-avatar"></a><span class="author-details"><a href="http://www.raywenderlich.com/u/Hollance" sl-processed="1">Hollance</a> <span class="post-date">on July 14, 2014, 10:13 AM</span></span></li>	</ul>
	<div class="comment-pages bottom-pages">[ <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1?pn=1#comments" sl-processed="1">1</a> , <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1?pn=2#comments" sl-processed="1">2</a> , <a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1?pn=3#comments" sl-processed="1">3</a> , <span>4</span> ]</div>	<script type="text/javascript">
		var razewareConfig = {
			pagingAmount : 15,
			topic_id : 16725,
			themeUrl: '/wp-content/themes/raywenderlich',
			non: 'asdf,'
		};
		
	</script>
   				</section>
			</div>
		</div>
	</div>
	<section id="secondary">
	<h1 id="other-items-of-interest">Other Items of Interest</h1>
	<section id="newsletter-signup" class="rw-module">
		<header>
			<h1>Ray's Monthly Newsletter</h1>
		</header>
		<div>
			<img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/starter-kit@2x.png" width="109" height="139">
			<p>Sign up to receive a monthly newsletter with my favorite dev links, and receive a <em>free epic-length tutorial</em> as a bonus!</p>
			<img src="">
			<form novalidate="" target="_blank" class="validate" name="mc-embedded-subscribe-form" id="mc-embedded-subscribe-form" method="post" action="http://raywenderlich.us1.list-manage.com/subscribe/post?u=1bc8e630b1599df629818e59b&id=83b6edc87f">
				<input type="text" id="mce-NAME" class="required" name="NAME" value="" placeholder="Your full name">
				<input type="email" id="mce-EMAIL" class="required email" name="EMAIL" value="" placeholder="Your best email">
				<input type="submit" class="button" id="mc-embedded-subscribe" name="subscribe" value="Sign Up!">
			</form>
		</div>
	</section>
	<section id="site-ads">
		<h1>Advertise with Us!</h1>
		<!-- BuySellAds.com Ad Code -->
		<!-- End BuySellAds.com Ad Code -->
		<!-- BuySellAds Zone Code -->
	        
	        
	        <div id="bsap_1274837" class="bsap_1274837 bsap"><a href="http://stats.buysellads.com/click.go?z=1274837&b=4917346&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.1705585198942572&link=http://designcode.io" onmouseover="window.status = &#39;http://designcode.io&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad1 odd" title="Learn iOS Design and Xcode" id="bsa_4917346" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/225368-1401913770.png" width="300" height="250" alt="Learn iOS Design and Xcode"></a></div>
	        <!-- End BuySellAds Zone Code -->
	                       
	        <!-- BuySellAds.com Zone Code -->
	        <div id="smallads">
	        	<div id="bsap_1260352" class="bsap_1260352 bsap"><a href="http://stats.buysellads.com/click.go?z=1260352&b=4890048&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.24091971782036126&link=http://interface.lesscode.co.nz/?utm_source=raywenderlich.com&utm_medium=display&utm_term=&utm_content=v3_sub1&utm_campaign=IF3" onmouseover="window.status = &#39;http://interface.lesscode.co.nz/?utm_source=raywenderlich.com&amp;utm_medium=display&amp;utm_term=&amp;utm_content=v3_sub1&amp;utm_campaign=IF3&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad1 odd" title="Advanced prototyping app for iOS." id="bsa_4890048" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/229192-1404346054.png" width="125" height="125" alt="Advanced prototyping app for iOS."></a><a href="http://stats.buysellads.com/click.go?z=1260352&b=2522228&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.1936822235584259&link=http://www.binpress.com/browse?q=gamedev&u=139&utm_source=RayWenderlich&utm_medium=banner125&utm_campaign=gamedev-zelda-complete" onmouseover="window.status = &#39;http://www.binpress.com/browse?q=gamedev&amp;u=139&amp;utm_source=RayWenderlich&amp;utm_medium=banner125&amp;utm_campaign=gamedev-zelda-complete&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad2 even" title="Complete game development starter kits for iOS" id="bsa_2522228" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/116182-1342359598.png" width="125" height="125" alt="Complete game development starter kits for iOS"></a><a href="http://stats.buysellads.com/click.go?z=1260352&b=3635927&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.20767047465778887&link=http://www.gummicube.com/app-store-optimization-service/?utm_source=raywenderlich.com&utm_medium=display&utm_content=ASO&utm_campaign=ASO" onmouseover="window.status = &#39;http://www.gummicube.com/app-store-optimization-service/?utm_source=raywenderlich.com&amp;utm_medium=display&amp;utm_content=ASO&amp;utm_campaign=ASO&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad3 odd" title="App Store Optimization that works.  Gummicube leverages real mobile data from the App Store and proprietary technology to optimize your app.  Trusted by 100&#39;s of developers." id="bsa_3635927" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/217710-1397241940.png" width="125" height="125" alt="App Store Optimization that works.  Gummicube leverages real mobile data from the App Store and proprietary technology to optimize your app.  Trusted by 100&#39;s of developers."></a><a href="http://stats.buysellads.com/click.go?z=1260352&b=4573417&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.940224084071815&link=http://computerrentals.com/products/4K-monitor-rental.php" onmouseover="window.status = &#39;http://computerrentals.com/products/4K-monitor-rental.php&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad4 even" title="4K Display" id="bsa_4573417" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/216173-1396391675.jpg" width="125" height="125" alt="4K Display"></a><a href="http://stats.buysellads.com/click.go?z=1260352&b=4520199&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.3598173300269991&link=https://sqlitepro.com" onmouseover="window.status = &#39;https://sqlitepro.com&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad5 odd" title="SQLite Professional - SQLite &amp; Core data management tool." id="bsa_4520199" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/195829-1383828912.png" width="125" height="125" alt="SQLite Professional - SQLite &amp; Core data management tool."></a><a href="http://stats.buysellads.com/click.go?z=1260352&b=4795148&g=&s=&sw=1366&sh=768&br=chrome,35,mac&r=0.061811613850295544&link=http://themeforest.net/item/x-the-ultimate-wordpress-theme/5871901?ref=themeco" onmouseover="window.status = &#39;http://themeforest.net/item/x-the-ultimate-wordpress-theme/5871901?ref=themeco&#39;; return true;" onmouseout="window.status=&#39;&#39;; return true;" class="ad6 even" title="X WordPress Theme" id="bsa_4795148" target="_blank" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/202713-1388094531.png" width="125" height="125" alt="X WordPress Theme"></a></div>
	        	<div style="clear:both"></div>
	        </div>
	        <div id="razeware_ads">
	        	<a href="https://itunes.apple.com/us/app/math-ninja-hd/id370144476?mt=8&uo=4&at=11ld4k" target="_blank" class="razewareads" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/MathNinja_125.gif" width="125" height="125" style="margin-left:15px"></a>
	        	<a href="http://ind13.com/" target="_blank" class="razewareads" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/ind13.gif" width="125" height="125" style="margin-left:15px"></a>	        	
	        	<!--<a href="https://itunes.apple.com/us/app/mahjong-cards-enjoy-relaxing/id849835788?ls=1&mt=8&at=11ld4k" target="_blank" class="razewareads"><img src="http://d1xzuxjlafny7l.cloudfront.net/downloads/MahjongCardsAd-125x125.png" width="125" height="125" style="margin-left:15px"></a>-->
	        	<!--<a href="https://itunes.apple.com/us/app/flappy-felipe/id820464950?mt=8&uo=4&at=11ld4k" target="_blank" class="razewareads"><img src="http://d1xzuxjlafny7l.cloudfront.net/downloads/FlappyFelipe.gif" width="125" height="125" style="margin-left:15px"></a>-->
	        </div>
			 
	        <!-- End BuySellAds.com Zone Code -->
	        <a href="http://www.raywenderlich.com/advertise" class="rw-button2" id="advertise-with-us" sl-processed="1">Advertise Here!</a>
	</section>

	<!--<section id="site-poll" class="rw-module">
		<header>
			<h1>Vote for Our Next Tutorial!</h1>
		</header>
						<div id="recent-posts" class="sidebar-entry">
	            <p>Every week, we alternate between Gaming and Non-Gaming tutorial votes.  This week: Non-Gaming!</p>
	            <ul>
	                <div id="polls-81" class="wp-polls">
	<form id="polls_form_81" class="wp-polls-form" action="/index.php" method="post">
		<p style="display: none;"><input type="hidden" id="poll_81_nonce" name="wp-polls-nonce" value="c282ce2b9c" /></p>
		<p style="display: none;"><input type="hidden" name="poll_id" value="81" /></p>
		<div id="polls-81-ans" class="wp-polls-ans"><ul class="wp-polls-ul">
		<li><input type="radio" id="poll-answer-491" name="poll_81" value="491" /> <label class="poll-answer-label" for="poll-answer-491">JQuery Crash Course</label></li>
		<li><input type="radio" id="poll-answer-492" name="poll_81" value="492" /> <label class="poll-answer-label" for="poll-answer-492">Inter Process Communication Tutorial for Objective-C</label></li>
		<li><input type="radio" id="poll-answer-493" name="poll_81" value="493" /> <label class="poll-answer-label" for="poll-answer-493">Update Parse tutorial for iOS 7</label></li>
		<li><input type="radio" id="poll-answer-494" name="poll_81" value="494" /> <label class="poll-answer-label" for="poll-answer-494">Introduction to RubyMotion for iOS</label></li>
		<li><input type="radio" id="poll-answer-495" name="poll_81" value="495" /> <label class="poll-answer-label" for="poll-answer-495">Another Mac OS X tutorial</label></li>
		<li><input type="radio" id="poll-answer-496" name="poll_81" value="496" /> <label class="poll-answer-label" for="poll-answer-496">Best iOS Animations in 2014</label></li>
		</ul><p><input type="button" id="vote" name="vote" value="CAST YOUR VOTE" class="Buttons" onclick="poll_vote(81);" /></p></div>
	</form>
</div>
<div id="polls-81-loading" class="wp-polls-loading"><img src="http://www.raywenderlich.com/wp-content/plugins/wp-polls/images/loading.gif" width="16" height="16" alt="Loading ..." title="Loading ..." class="wp-polls-image" />&nbsp;Loading ...</div>
	            </ul>
	
	    		<p><em>Last week's winner</em>:<span class="next-weeks-tutorial"> How to make a game like Cut the Rope with SpriteKit.</span>  Coming soon!				<p class="suggest-a-tutorial"><a href="http://www.raywenderlich.com/forums/viewtopic.php?f=2&t=284">Suggest a Tutorial</a> - <a href="http://www.raywenderlich.com/tutorial-vote-results">Past Results</a></p>
	        </div>
	        	
	</section>-->
	
	<section id="site-poll" class="rw-module">
		<header>
			<h1>Hang Out With Us!</h1>
		</header>			
			<div class="sidebar-entry">
	            <p>Every month, we have a free live Tech Talk - come hang out with us!</p><br>	            
	            <p>Coming up in July: Facebook Pop Tech Talk!</p>
	            <a href="https://plus.google.com/u/0/events/ceef32qppnff24tjaej9sbmlo0g" class="rw-button2" sl-processed="1">Sign Up - July</a>	
	        </div>	        
	</section>
	
	<section id="site-poll" class="rw-module">
		<header>
			<h1>RWDevCon Conference?</h1>
		</header>
						<div id="recent-posts" class="sidebar-entry">
	            <p>We are considering having an official raywenderlich.com conference called <em>RWDevCon</em> in DC in early 2015.</p><p>The conference would be focused on high quality Swift/iOS 8 technical content, and connecting as a community.</p>
	            <p>Would this be something you'd be interested in?</p>
	            <ul>
	                <div id="polls-84" class="wp-polls">
	<form id="polls_form_84" class="wp-polls-form" action="http://www.raywenderlich.com/index.php" method="post">
		<p style="display: none;"><input type="hidden" id="poll_84_nonce" name="wp-polls-nonce" value="785a7220fe"></p>
		<p style="display: none;"><input type="hidden" name="poll_id" value="84"></p>
		<div id="polls-84-ans" class="wp-polls-ans"><ul class="wp-polls-ul">
		<li><input type="radio" id="poll-answer-518" name="poll_84" value="518"> <label class="poll-answer-label" for="poll-answer-518">Yes - would prefer weekend</label></li>
		<li><input type="radio" id="poll-answer-519" name="poll_84" value="519"> <label class="poll-answer-label" for="poll-answer-519">Yes - would prefer weekdays</label></li>
		<li><input type="radio" id="poll-answer-520" name="poll_84" value="520"> <label class="poll-answer-label" for="poll-answer-520">No - not interested</label></li>
		<li><input type="radio" id="poll-answer-521" name="poll_84" value="521"> <label class="poll-answer-label" for="poll-answer-521">No - not a good location</label></li>
		<li><input type="radio" id="poll-answer-522" name="poll_84" value="522"> <label class="poll-answer-label" for="poll-answer-522">No - not a good time</label></li>
		</ul><p><input type="button" id="vote" name="vote" value="CAST YOUR VOTE" class="Buttons" onclick="poll_vote(84);"></p></div>
	</form>
</div>
<div id="polls-84-loading" class="wp-polls-loading"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/loading.gif" width="16" height="16" alt="Loading ..." title="Loading ..." class="wp-polls-image">&nbsp;Loading ...</div>
	            </ul>		    		
	        </div>
	        	
	</section>
	
	<section id="our-books" class="rw-module">
		<header>
			<h1>Our Books</h1>
		</header>
		<div>
			<ul class="books">
				<li><a href="http://www.raywenderlich.com/store/ios-8-by-tutorials" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/i8t@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/swift-by-tutorials" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/swt@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/core-data-tutorials-ios-8-swift-edition" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/cdt@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/ios-games-by-tutorials" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/skt@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/ios-7-by-tutorials" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/i7t@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/ios-6-by-tutorials" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/i6t@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/beat-em-up-game-starter-kit" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/bgsk@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/platformer-game-starter-kit" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/pgsk@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/space-game-starter-kit-2" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/sgsk@2x.png" width="110" height="142"></a></li><li><a href="http://www.raywenderlich.com/store/ios-apprentice" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/ia1234@2x.png" width="110" height="142"></a></li>			</ul>
		</div>
	</section>
	
					<section id="popular-tutorials" class="rw-module">
					<header>
						<h1>Popular Tutorials</h1>
					</header>
					<div>
						<div><ul id="difficulty-selector"><li id="easy-difficulty" data-tutorial-list="beginner-tutorials" class="selected"><a href="" sl-processed="1">BEGINNER</a></li><li id="medium-difficulty" data-tutorial-list="medium-tutorials"><a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" sl-processed="1">MEDIUM</a></li><li id="hard-difficulty" data-tutorial-list="hard-tutorials"><a href="http://www.raywenderlich.com/75270/make-game-like-candy-crush-with-swift-tutorial-part-1#" sl-processed="1">EXPERT</a></li></ul><ul id="beginner-tutorials" class="tutorial-list"><li><a href="http://www.raywenderlich.com/25205/beginning-unity-3d-for-ios-part-13" title="Permalink to Beginning Unity 3D for iOS: Part 1/3" sl-processed="1"><img width="46" height="41" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/beginning-unity.png" class="attachment-46x46 wp-post-image" alt="Permalink to Beginning Unity 3D for iOS: Part 1/3" title="Permalink to Beginning Unity 3D for iOS: Part 1/3"></a><p><a href="http://www.raywenderlich.com/25205/beginning-unity-3d-for-ios-part-13" title="Permalink to Beginning Unity 3D for iOS: Part 1/3" sl-processed="1">Beginning Unity 3D for iOS: Part 1/3</a></p></li><li><a href="http://www.raywenderlich.com/25736/how-to-make-a-simple-iphone-game-with-cocos2d-2-x-tutorial" title="Permalink to How To Make A Simple iPhone Game with Cocos2D 2.X Tutorial" sl-processed="1"><img width="46" height="40" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/TutorialScreenshot1-150x132.jpg" class="attachment-46x46 wp-post-image" alt="Permalink to How To Make A Simple iPhone Game with Cocos2D 2.X Tutorial" title="Permalink to How To Make A Simple iPhone Game with Cocos2D 2.X Tutorial"></a><p><a href="http://www.raywenderlich.com/25736/how-to-make-a-simple-iphone-game-with-cocos2d-2-x-tutorial" title="Permalink to How To Make A Simple iPhone Game with Cocos2D 2.X Tutorial" sl-processed="1">How To Make A Simple iPhone Game with Cocos2D 2.X Tutorial</a></p></li><li><a href="http://www.raywenderlich.com/21320/objectively-speaking-a-crash-course-in-objective-c-ios6" title="Permalink to Objectively Speaking: A Crash Course in Objective-C for iOS 6" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/ios6-objectivec-crash-course-64x64.jpg" class="attachment-46x46 wp-post-image" alt="Permalink to Objectively Speaking: A Crash Course in Objective-C for iOS 6" title="Permalink to Objectively Speaking: A Crash Course in Objective-C for iOS 6"></a><p><a href="http://www.raywenderlich.com/21320/objectively-speaking-a-crash-course-in-objective-c-ios6" title="Permalink to Objectively Speaking: A Crash Course in Objective-C for iOS 6" sl-processed="1">Objectively Speaking: A Crash Course in Objective-C for iOS 6</a></p></li><li><a href="http://www.raywenderlich.com/1797/ios-tutorial-how-to-create-a-simple-iphone-app-part-1" title="Permalink to iOS Tutorial: How To Create A Simple iPhone App: Part 1/3" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/ladybug-150x150.jpg" class="attachment-46x46 wp-post-image" alt="Permalink to iOS Tutorial: How To Create A Simple iPhone App: Part 1/3" title="Permalink to iOS Tutorial: How To Create A Simple iPhone App: Part 1/3"></a><p><a href="http://www.raywenderlich.com/1797/ios-tutorial-how-to-create-a-simple-iphone-app-part-1" title="Permalink to iOS Tutorial: How To Create A Simple iPhone App: Part 1/3" sl-processed="1">iOS Tutorial: How To Create A Simple iPhone App: Part 1/3</a></p></li></ul><ul id="medium-tutorials" class="tutorial-list"><li><a href="http://www.raywenderlich.com/21365/introduction-to-mapkit-in-ios-6-tutorial" title="Permalink to Introduction to MapKit in iOS 6 Tutorial" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/MapKit-64x64.png" class="attachment-46x46 wp-post-image" alt="Permalink to Introduction to MapKit in iOS 6 Tutorial" title="Permalink to Introduction to MapKit in iOS 6 Tutorial"></a><p><a href="http://www.raywenderlich.com/21365/introduction-to-mapkit-in-ios-6-tutorial" title="Permalink to Introduction to MapKit in iOS 6 Tutorial" sl-processed="1">Introduction to MapKit in iOS 6 Tutorial</a></p></li><li><a href="http://www.raywenderlich.com/21081/introduction-to-in-app-purchases-in-ios-6-tutorial" title="Permalink to Introduction to In-App Purchases in iOS 6 Tutorial" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/hangman-64x64.png" class="attachment-46x46 wp-post-image" alt="Permalink to Introduction to In-App Purchases in iOS 6 Tutorial" title="Permalink to Introduction to In-App Purchases in iOS 6 Tutorial"></a><p><a href="http://www.raywenderlich.com/21081/introduction-to-in-app-purchases-in-ios-6-tutorial" title="Permalink to Introduction to In-App Purchases in iOS 6 Tutorial" sl-processed="1">Introduction to In-App Purchases in iOS 6 Tutorial</a></p></li><li><a href="http://www.raywenderlich.com/20881/beginning-auto-layout-part-1-of-2" title="Permalink to Beginning Auto Layout in iOS 6: Part 1/2" sl-processed="1"><img width="46" height="43" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Rage-French-250x237_2a86cb01edb555eef2b7e3f63c35602d.png" class="attachment-46x46 wp-post-image" alt="Permalink to Beginning Auto Layout in iOS 6: Part 1/2" title="Permalink to Beginning Auto Layout in iOS 6: Part 1/2"></a><p><a href="http://www.raywenderlich.com/20881/beginning-auto-layout-part-1-of-2" title="Permalink to Beginning Auto Layout in iOS 6: Part 1/2" sl-processed="1">Beginning Auto Layout in iOS 6: Part 1/2</a></p></li><li><a href="http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1" title="Permalink to Beginning Storyboards in iOS 5 Part 1" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/storyboards-64x64.png" class="attachment-46x46 wp-post-image" alt="Permalink to Beginning Storyboards in iOS 5 Part 1" title="Permalink to Beginning Storyboards in iOS 5 Part 1"></a><p><a href="http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1" title="Permalink to Beginning Storyboards in iOS 5 Part 1" sl-processed="1">Beginning Storyboards in iOS 5 Part 1</a></p></li><li><a href="http://www.raywenderlich.com/2941/how-to-write-a-simple-phpmysql-web-service-for-an-ios-app" title="Permalink to How To Write A Simple PHP/MySQL Web Service for an iOS App" sl-processed="1"><img width="46" height="39" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/WebServicesRule-150x130.jpg" class="attachment-46x46 wp-post-image" alt="Permalink to How To Write A Simple PHP/MySQL Web Service for an iOS App" title="Permalink to How To Write A Simple PHP/MySQL Web Service for an iOS App"></a><p><a href="http://www.raywenderlich.com/2941/how-to-write-a-simple-phpmysql-web-service-for-an-ios-app" title="Permalink to How To Write A Simple PHP/MySQL Web Service for an iOS App" sl-processed="1">How To Write A Simple PHP/MySQL Web Service for an iOS App</a></p></li></ul><ul id="hard-tutorials" class="tutorial-list"><li><a href="http://www.raywenderlich.com/32960/apple-push-notification-services-in-ios-6-tutorial-part-1" title="Permalink to Apple Push Notification Services in iOS 6 Tutorial: Part 1/2" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/APNS1-64x64.png" class="attachment-46x46 wp-post-image" alt="Permalink to Apple Push Notification Services in iOS 6 Tutorial: Part 1/2" title="Permalink to Apple Push Notification Services in iOS 6 Tutorial: Part 1/2"></a><p><a href="http://www.raywenderlich.com/32960/apple-push-notification-services-in-ios-6-tutorial-part-1" title="Permalink to Apple Push Notification Services in iOS 6 Tutorial: Part 1/2" sl-processed="1">Apple Push Notification Services in iOS 6 Tutorial: Part 1/2</a></p></li><li><a href="http://www.raywenderlich.com/30288/nsregularexpression-tutorial-and-cheat-sheet" title="Permalink to NSRegularExpression Tutorial and Cheat Sheet" sl-processed="1"><img width="46" height="37" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/checklist.png" class="attachment-46x46 wp-post-image" alt="Permalink to NSRegularExpression Tutorial and Cheat Sheet" title="Permalink to NSRegularExpression Tutorial and Cheat Sheet"></a><p><a href="http://www.raywenderlich.com/30288/nsregularexpression-tutorial-and-cheat-sheet" title="Permalink to NSRegularExpression Tutorial and Cheat Sheet" sl-processed="1">NSRegularExpression Tutorial and Cheat Sheet</a></p></li><li><a href="http://www.raywenderlich.com/33750/cocos2d-x-tutorial-for-ios-and-android-getting-started" title="Permalink to Cocos2D-X Tutorial for iOS and Android: Getting Started" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/Cocos2DX-64x64.png" class="attachment-46x46 wp-post-image" alt="Permalink to Cocos2D-X Tutorial for iOS and Android: Getting Started" title="Permalink to Cocos2D-X Tutorial for iOS and Android: Getting Started"></a><p><a href="http://www.raywenderlich.com/33750/cocos2d-x-tutorial-for-ios-and-android-getting-started" title="Permalink to Cocos2D-X Tutorial for iOS and Android: Getting Started" sl-processed="1">Cocos2D-X Tutorial for iOS and Android: Getting Started</a></p></li><li><a href="http://www.raywenderlich.com/5223/beginning-opengl-es-2-0-with-glkit-part-1" title="Permalink to Beginning OpenGL ES 2.0 with GLKit Part 1" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/iOS_feast_mini_GLKit_250.jpg" class="attachment-46x46 wp-post-image" alt="Permalink to Beginning OpenGL ES 2.0 with GLKit Part 1" title="Permalink to Beginning OpenGL ES 2.0 with GLKit Part 1"></a><p><a href="http://www.raywenderlich.com/5223/beginning-opengl-es-2-0-with-glkit-part-1" title="Permalink to Beginning OpenGL ES 2.0 with GLKit Part 1" sl-processed="1">Beginning OpenGL ES 2.0 with GLKit Part 1</a></p></li><li><a href="http://www.raywenderlich.com/934/core-data-tutorial-for-ios-getting-started" title="Permalink to Core Data Tutorial for iOS: Getting Started" sl-processed="1"><img width="46" height="46" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/CoreData-64x64.png" class="attachment-46x46 wp-post-image" alt="Permalink to Core Data Tutorial for iOS: Getting Started" title="Permalink to Core Data Tutorial for iOS: Getting Started"></a><p><a href="http://www.raywenderlich.com/934/core-data-tutorial-for-ios-getting-started" title="Permalink to Core Data Tutorial for iOS: Getting Started" sl-processed="1">Core Data Tutorial for iOS: Getting Started</a></p></li></ul></div>					</div>
				</section>
			
	<section id="tutorial-team" class="rw-module">
		<header>
			<h1>Our Team</h1>
		</header>
		<div>
			<h2>Tutorial Team</h2>
			<ul><li><a href="http://www.raywenderlich.com/about#krichter" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/250.thumbnail.jpg" alt="Kyle Richter" class="user-avatar" width="100" height="100"></a></li><li><a href="http://www.raywenderlich.com/about#psholtz" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(2).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#sgardner" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(3).php" width="100" height="100" class="user-avatar"></a></li></ul><p>... <a href="http://www.raywenderlich.com/about#abt_tutorial-team" sl-processed="1">52 total!</a></p><h2>Update Team</h2><ul><li><a href="http://www.raywenderlich.com/about#rd" antoni'="" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/198.thumbnail.png" alt="Riccardo D&#39;Antoni" class="user-avatar" width="100" height="100"></a></li><li><a href="http://www.raywenderlich.com/about#rturton" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(4).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#rbristow" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(5).php" width="100" height="100" class="user-avatar"></a></li></ul><h2>Editorial Team</h2><ul><li><a href="http://www.raywenderlich.com/about#vwenderlich" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(6).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#gheo" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(7).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#bphillips" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(8).php" width="100" height="100" class="user-avatar"></a></li></ul><p>... <a href="http://www.raywenderlich.com/about#abt_editorial-team" sl-processed="1">23 total!</a></p><h2>Code Team</h2><ul><li><a href="http://www.raywenderlich.com/about#otherox" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/230.thumbnail.jpg" alt="Orta Therox" class="user-avatar" width="100" height="100"></a></li></ul><p>... <a href="http://www.raywenderlich.com/about#abt_code-team" sl-processed="1">1 total!</a></p><h2>Translation Team</h2><ul><li><a href="http://www.raywenderlich.com/about#mmukhina" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/247.thumbnail.jpg" alt="Marina Mukhina" class="user-avatar" width="100" height="100"></a></li><li><a href="http://www.raywenderlich.com/about#ptorres" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(9).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#zxu" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/149.thumbnail.jpg" alt="Zihan Xu" class="user-avatar" width="100" height="100"></a></li></ul><p>... <a href="http://www.raywenderlich.com/about#abt_translation-team" sl-processed="1">33 total!</a></p><h2>Subject Matter Experts</h2><ul><li><a href="http://www.raywenderlich.com/about#mvalenzuela" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(10).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#rbelton" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(11).php" width="100" height="100" class="user-avatar"></a></li><li><a href="http://www.raywenderlich.com/about#aeberbach" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/file(12).php" width="100" height="100" class="user-avatar"></a></li></ul><p>... <a href="http://www.raywenderlich.com/about#abt_subject-matter-experts" sl-processed="1">4 total!</a></p>		</div>
	</section>
</section>	</div></div><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/bLBBWlYJp_w.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/bLBBWlYJp_w(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div>
			<footer id="colophon" class="clearfix">
		<h1 id="about-raywenderlich">About RayWenderlich.com</h1><div class="wrapper clearfix"><div id="css-table-enclosure"><div class="forum-posts-sep footer-separator first table-col"></div><div class="forum-posts table-col"><h2>Recent Forum Posts</h2><ul class="comments"><li><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/3721b45380491b146380ff6f7bc01064" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"><div>Never mind.  Deleting the app from the simulator did the trick.  Very strange. ...<br> in <a href="http://www.raywenderlich.com/forums/viewtopic.php?f=11&t=17832" sl-processed="1">addObject problem</a></div></li><li><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/3721b45380491b146380ff6f7bc01064" alt="" width="100" height="100" data-site-url="http://cdn1.raywenderlich.com/wp-content/themes/raywenderlich" class="user-avatar gravatar"><div>For some reason the addObject method is not adding the object to my NSMutableArray.  (2) should say  ...<br> in <a href="http://www.raywenderlich.com/forums/viewtopic.php?f=11&t=17832" sl-processed="1">addObject problem</a></div></li></ul><a href="http://www.raywenderlich.com/forums/" class="RWButton" sl-processed="1">VISIT THE FORUM »</a></div><div class="facebook-page-sep footer-separator table-col"></div><div class="facebook-page table-col"><h2>Like Us on Facebook</h2><div class="like-box"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/small-logo@2x.png" width="50" height="50" id="small-logo"><h3>Ray Wenderlich</h3>							<iframe src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/like(1).html" allowtransparency="true" frameborder="0" scrolling="no" style="width: 50px; height: 20px;"></iframe>
							</div>						    <p class="page-like-count"><span id="like-count">5311</span> people like <a href="https://www.facebook.com/raywenderlich" target="_blank" sl-processed="1">Ray Wenderlich</a></p>
							<div class="fb-window">
								<div class="fb-like-box fb_iframe_widget" data-href="https://www.facebook.com/pages/raywenderlichcom/516533855059578" data-width="292" data-show-faces="true" data-colorscheme="dark" data-stream="false" data-header="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=&amp;color_scheme=dark&amp;header=false&amp;href=https%3A%2F%2Fwww.facebook.com%2Fpages%2Fraywenderlichcom%2F516533855059578&amp;locale=en_US&amp;sdk=joey&amp;show_faces=true&amp;stream=false&amp;width=292"><span style="vertical-align: bottom; width: 292px; height: 241px;"><iframe name="f20a8d59b4" width="292px" height="1000px" frameborder="0" allowtransparency="true" scrolling="no" title="fb:like_box Facebook Social Plugin" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/like_box.html" style="border: none; visibility: visible; width: 292px; height: 241px;" class=""></iframe></span></div>
							</div>
						</div><div class="latest-tweets-sep footer-separator table-col"></div><div class="latest-tweets table-col"><h2>Our Recent Tweets</h2><ul id="rw-tweet-list"><li><a href="http://twitter.com/frosty" target="_blank" class="tweet-author" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/avatar_normal.jpg" alt="frosty" width="48" height="48"></a><div class="tweet-content"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/tweet-arrow@2x.png" class="tweet-arrow" width="8" height="14">“Pauled Pork”… Really?! <a href="http://t.co/7yq7GGSChx" target="_blank" sl-processed="1">http://t.co/7yq7GGSChx</a><br><a href="http://twitter.com/frosty" target="_blank" sl-processed="1">James Frost</a> -<span class="tweet-time">16 minutes ago</span></div></li><li><a href="http://twitter.com/Paradox927" target="_blank" class="tweet-author" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/28dafada491a796c6a00575ebdfb90fe_normal.jpeg" alt="Paradox927" width="48" height="48"></a><div class="tweet-content"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/tweet-arrow@2x.png" class="tweet-arrow" width="8" height="14">Mostly because I haven't mentioned it in awhile. Have you heard of Crow's Quest? No? Take a look: <a href="https://t.co/B2eiHeZx6N" target="_blank" sl-processed="1">https://t.co/B2eiHeZx6N</a><br><a href="http://twitter.com/Paradox927" target="_blank" sl-processed="1">Tammy L Coron</a> -<span class="tweet-time">22 minutes ago</span></div></li></ul><a href="https://twitter.com/rwenderlich/raywenderlich-com-team" class="RWButton" sl-processed="1">FOLLOW US ON TWITTER</a></div><div class="footer-separator last table-col"></div></div></div><div class="navigation-band"><div class="wrapper"><div class="left-col">© 2014 <a href="http://www.razeware.com/" sl-processed="1">Razeware LLC. All rights reserved.</a></div><div class="right-col"><ul><li><a href="http://www.raywenderlich.com/faq" sl-processed="1">FAQ</a></li><li><a href="http://www.raywenderlich.com/advertise" sl-processed="1">ADVERTISE</a></li><li><a href="http://www.raywenderlich.com/contact" sl-processed="1">CONTACT</a></li></ul></div></div></div><div id="gearbox"><div class="wrapper"><div id="left-gears"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_small@2x.png" width="56" height="56" class="left-gear clockwise-motion small-gear gear" id="gear1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_medium@2x.png" width="66" height="66" class="left-gear counter-clockwise-motion  medium-gear gear" id="gear2"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_large@2x.png" width="96" height="96" class="left-gear clockwise-motion large-gear gear" id="gear3"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_medium@2x.png" width="67" height="67" class="left-gear counter-clockwise-motion medium-gear gear" id="gear4"></div><a href="http://www.raywenderlich.com/" id="footer-logo" sl-processed="1"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/logo_stage5@2x.png" width="160" height="75" border="0" class="logo-sat"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/logo_stage1@2x.png" width="160" height="75" border="0" class="logo">
									</a><div id="right-gears"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_small@2x.png" width="51" height="50" class="right-gear clockwise-motion small-gear gear" id="gear5"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_medium@2x.png" width="67" height="67" class="right-gear counter-clockwise-motion  medium-gear gear" id="gear6"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_large@2x.png" width="96" height="96" class="right-gear clockwise-motion large-gear gear" id="gear7"><img src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/gear_medium@2x.png" width="67" height="67" class="right-gear counter-clockwise-motion  medium-gear gear" id="gear8"></div></div></div><footer><script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/jquery.cookie.js"></script>
<script type="text/javascript">
    jQuery(document).ready(function() {
        var count;
        if ( !jQuery.cookie('wwsgd_visits') ) {
            count = 1;
        }
        else {
            count = parseInt(jQuery.cookie('wwsgd_visits'), 10) + 1;
        }
        jQuery.cookie('wwsgd_visits', count, { expires: 365, path: "/" });

        if ( count <= 5 ) {
            jQuery(".wwsgd").show();
        }
    });
</script>
<!-- Survey and Quizzes Powered by WP Survey And Quiz Tool 2.13.1 iain.cambridge at fubra.com --><script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/widgets.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var pollsL10n = {"ajax_url":"http:\/\/www.raywenderlich.com\/wp-admin\/admin-ajax.php","text_wait":"Your last request is still being processed. Please wait a while ...","text_valid":"Please choose a valid poll answer.","text_multiple":"Maximum number of choices allowed: ","show_loading":"1","show_fading":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./How to Make a Game Like Candy Crush with Swift Tutorial_files/polls-js.js"></script>
		
		<script type="text/javascript">var _merchantSettings=_merchantSettings || [];_merchantSettings.push(['AT', '11ld4k']);(function(){var autolink=document.createElement('script');autolink.type='text/javascript';autolink.async=true; autolink.src='http://autolinkmaker.itunes.apple.com/js/itunes_autolinkmaker.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(autolink, s);})();</script>
				<script>
			if (jQuery.browser.msie) { jQuery("html").addClass("msie"); }
			if (typeof window.chrome === "object") { jQuery("html").addClass("chrome"); }
		</script>
	



<!-- Dynamic page generated in 2.147 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2014-07-15 09:01:29 -->

<!-- Compression = gzip --></footer></footer><div class="swiftype-widget"><div class="autocomplete" style="position: absolute; z-index: 9999; top: 97px; left: 1078px; width: 203px; display: none;"><ul></ul></div></div></body></html>